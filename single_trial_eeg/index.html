<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Single-Trial EEG Analysis</title>
  <meta name="description" content="Single-Trial EEG Analysis" />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="Single-Trial EEG Analysis" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Single-Trial EEG Analysis" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  

<link rel="next" href="smith-and-kutas-2015a.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html"><i class="fa fa-check"></i><b>1</b> Frömer et al. (2018)</a><ul>
<li class="chapter" data-level="1.1" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#comparison-of-methods"><i class="fa fa-check"></i><b>1.1</b> Comparison of Methods</a><ul>
<li class="chapter" data-level="1.1.1" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#anova-limitations"><i class="fa fa-check"></i><b>1.1.1</b> ANOVA limitations</a></li>
<li class="chapter" data-level="1.1.2" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#advantages-of-mixed-models"><i class="fa fa-check"></i><b>1.1.2</b> Advantages of mixed Models</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#determining-time-windows"><i class="fa fa-check"></i><b>1.2</b> Determining Time Windows</a></li>
<li class="chapter" data-level="1.3" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#cookbook"><i class="fa fa-check"></i><b>1.3</b> Cookbook</a><ul>
<li class="chapter" data-level="1.3.1" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#example-task"><i class="fa fa-check"></i><b>1.3.1</b> Example Task</a></li>
<li class="chapter" data-level="1.3.2" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#scripts"><i class="fa fa-check"></i><b>1.3.2</b> Scripts</a></li>
<li class="chapter" data-level="1.3.3" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#froemeranalyses"><i class="fa fa-check"></i><b>1.3.3</b> Analyses</a></li>
<li class="chapter" data-level="1.3.4" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#model"><i class="fa fa-check"></i><b>1.3.4</b> Model</a></li>
<li class="chapter" data-level="1.3.5" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#brain-stuff"><i class="fa fa-check"></i><b>1.3.5</b> Brain Stuff</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#behavioural-results"><i class="fa fa-check"></i><b>1.4</b> Behavioural Results</a><ul>
<li class="chapter" data-level="1.4.1" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#comparison-to-standard-anova-and-regression"><i class="fa fa-check"></i><b>1.4.1</b> Comparison to standard ANOVA and regression</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#brain-results-n2"><i class="fa fa-check"></i><b>1.5</b> Brain Results N2</a></li>
<li class="chapter" data-level="1.6" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#brain-results-p3b"><i class="fa fa-check"></i><b>1.6</b> Brain Results P3b</a></li>
<li class="chapter" data-level="1.7" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#results-brain-behaviour-relationship"><i class="fa fa-check"></i><b>1.7</b> Results Brain Behaviour Relationship</a></li>
<li class="chapter" data-level="1.8" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#to-do"><i class="fa fa-check"></i><b>1.8</b> TO DO</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="smith-and-kutas-2015a.html"><a href="smith-and-kutas-2015a.html"><i class="fa fa-check"></i><b>2</b> Smith and Kutas 2015a</a></li>
<li class="chapter" data-level="3" data-path="smith-and-kutas-2015b.html"><a href="smith-and-kutas-2015b.html"><i class="fa fa-check"></i><b>3</b> Smith and Kutas 2015b</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Single-Trial EEG Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">Single-Trial EEG Analysis</h1>
<h2 class="subtitle"><em>Mixed Models and Friends</em></h2>
</div>
<div id="fromer-et-al.-2018" class="section level1">
<h1><span class="header-section-number">1</span> Frömer et al. (2018)</h1>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5810264/">Frömer</a> <span class="citation">(2018)</span>. <strong>Group-Level EEG-Processing Pipeline for Flexible Single Trial-Based Analyses Including Linear Mixed Models</strong></p>
<p>Here we present an application of an EEG processing pipeline customizing EEGLAB and FieldTrip functions, specifically optimized to flexibly analyze EEG data based on single trial information. The key component of our approach is to create a comprehensive 3-D EEG data structure including all trials and all participants maintaining the original order of recording. This allows straightforward access to subsets of the data based on any information available in a behavioral data structure matched with the EEG data (experimental conditions, but also performance indicators, such accuracy or RTs of single trials). In the present study we exploit this structure to compute linear mixed models (LMMs, using lmer in R) including random intercepts and slopes for items. This information can easily be read out fromthematched behavioral data, whereas itmight not be accessible in traditional ERP approaches without substantial effort.We further provide easily adaptable scripts for performing cluster-based permutation tests (as implemented in FieldTrip), as a more robust alternative to traditional omnibus ANOVAs. Our approach is particularly advantageous for data with parametric within-subject covariates (e.g., performance) and/or multiple complex stimuli (such as words, faces or objects) that vary in features affecting cognitive processes and ERPs (such as word frequency, salience or familiarity), which are sometimes hard to control experimentally or might themselves constitute variables of interest. The present dataset was recorded from 40 participants who performed a visual search task on previously unfamiliar objects, presented either visually intact or blurred. MATLAB as well as R scripts are provided that can be adapted to different datasets.</p>
<div id="comparison-of-methods" class="section level2">
<h2><span class="header-section-number">1.1</span> Comparison of Methods</h2>
<p><img src="pics/froemer_tab1.jpg" width="90%" /></p>
<div id="anova-limitations" class="section level3">
<h3><span class="header-section-number">1.1.1</span> ANOVA limitations</h3>
<p>ANOVA means: averaging within conditions and participants</p>
<ol style="list-style-type: decimal">
<li>Limited by the <span style=" font-weight: bold;    color: #E8793A !important;">implicit assumption</span> that every participant’s average has the <span style=" font-weight: bold;    color: #6BBFA6 !important;">same quality</span> and that the <span style=" font-weight: bold;    color: #6BBFA6 !important;">same number of observations</span> constitutes each of those averages.</li>
</ol>
<ul>
<li>Differences in performance accuracy and artifact rejection <span class="math inline">\(\to\)</span> <span style=" font-weight: bold;    color: #6BBFA6 !important;">Unequal numbers of trials</span> contributing to individual averages within participants and conditions.</li>
<li><span style=" font-weight: bold;    color: #E8793A !important;">But:</span> All these averages have the same weights in an ANOVA.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><p>Limited by the <span style=" font-weight: bold;    color: #E8793A !important;">implicit assumption</span> that experimental manipulations yield<span style=" font-weight: bold;    color: #6BBFA6 !important;">uniform effects</span> across all participants and items.</p></li>
<li><p>Limited by the <span style=" font-weight: bold;    color: #E8793A !important;">dependency on discrete factor levels</span> and its resulting inability to test for parametric effects.</p></li>
</ol>
</div>
<div id="advantages-of-mixed-models" class="section level3">
<h3><span class="header-section-number">1.1.2</span> Advantages of mixed Models</h3>
<ul>
<li>Can deal with <span style=" font-weight: bold;    color: #6BBFA6 !important;">unequal numbers of observations</span> per cell and missing values.</li>
<li>Regularised estimates: More robust, <span style=" font-weight: bold;    color: #6BBFA6 !important;">avoiding type I errors</span>.</li>
<li>Many observations needed for averages per discrete category; but not when discrete variables can be left intact.
<ul>
<li>“To illustrate, when investigating the effect of reward on feedback related potentials, in order to obtain reliable ERPs for each type of reward one would need at least 30 trials of each reward magnitude. On the other hand, in a regression-based approach, on the same overall number of trials, reward could be varied continuously from a given low to a given high reward, and linear, but also quadratic or cubic effects of reward across that range could be tested”</li>
</ul></li>
</ul>
<p><span class="citation">Smith &amp; Kutas (2015a)</span> describe an alternative to averaging: ERPs can be estimated using regression procedures; the averaging method is merely a special case of the least squares method underlying regression.</p>
</div>
</div>
<div id="determining-time-windows" class="section level2">
<h2><span class="header-section-number">1.2</span> Determining Time Windows</h2>
<ul>
<li>Determining the right time-windows and regions of interest (ROIs) to test group-level effects is a challenge.
<ul>
<li>The problem is amplified when new effects are explored and there is no substantial previous literature to help develop direct hypotheses on the nature of those effects (e.g., time course or spatial distribution).</li>
</ul></li>
<li>One statistically robust way to determine suitable time windows and electrode sites are <span style=" font-weight: bold;    color: #E8793A !important;">cluster-based permutation tests (CBPT)</span> as implemented in FieldTrip.
<ul>
<li>In a nutshell, this approach tests the null hypothesis that observations for different conditions are drawn fromthe same distribution and are therefore <span style=" font-weight: bold;    color: #6BBFA6 !important;">exchangeable</span>.</li>
<li>Therefore, if observing similar effects <span style=" font-weight: bold;    color: #6BBFA6 !important;">under random assignment of condition labels</span> is highly unlikely (less than 5% of the permutations show them), this hypothesis is rejected and the observed condition effect is considered significant.</li>
<li>The cluster-based procedure further makes use of the EEG property that observations on adjacent sites and time points are often correlated, because a real effect most likely affects multiple electrodes similarly and persists across several tens to hundreds of milliseconds (or sampling points).</li>
</ul></li>
</ul>
</div>
<div id="cookbook" class="section level2">
<h2><span class="header-section-number">1.3</span> Cookbook</h2>
<p>Data and Scripts can be found <a href="https://osf.io/hdxvb/">here</a>.</p>
<div id="example-task" class="section level3">
<h3><span class="header-section-number">1.3.1</span> Example Task</h3>
<p><img src="pics/froemer_fig2.jpg" width="100%" /></p>
<ul>
<li>Visual detection task</li>
<li>Identify position (left or right) of deviating object (top and bottom row excluded from analysis)</li>
<li>All objects within one trial blurred or not (difficulty)</li>
<li>Behavioural DVs: Accuracy and reaction time</li>
<li>Brain DVs: ERP magnitude</li>
</ul>
</div>
<div id="scripts" class="section level3">
<h3><span class="header-section-number">1.3.2</span> Scripts</h3>
<ul>
<li><ol style="list-style-type: decimal">
<li>EEG-data processing with EEGlab for data cleaning, structuring and plotting</li>
</ol></li>
<li><ol start="2" style="list-style-type: decimal">
<li>applying cluster-based permutationtests as implemented in FieldTrip for data screening and ROI selection</li>
</ol></li>
<li><ol start="3" style="list-style-type: decimal">
<li>single-trial based LMM analyses using the lme4 package for R</li>
</ol></li>
</ul>
<p><img src="pics/froemer_fig1.jpg" width="100%" /></p>
<ul>
<li>Preprocessing in <code>F01_preprocessing.m</code>.</li>
<li>All trials of all participants were combined in a 3D matrix (channels, time points, trials by participants), which forms the basis for all further ERP analyses (<code>F02_epoching_structuring.m</code>).
<ul>
<li><span style=" font-weight: bold;    color: #6BBFA6 !important;">Can we achieve the same structure when Data was preprocessed in Brain Vision Analyzer?</span></li>
</ul></li>
<li>Single trial information for CBPT and plotting was exported to Matlab in the same analysis script, <code>F00_behavioral_data_and_LMM_analyses.R</code>.
<ul>
<li><span class="math inline">\(\to\)</span> Not sure what is first? <code>F00</code> seems to indicate that this Script is initially run, but you’d need CBPTs before LMM. Probably, <code>F00</code> is calling the other scripts first and then conducting the LMM analyses?</li>
</ul></li>
<li>CBPT using FieldTrip in <code>F04_permutation tests.m</code>
<ul>
<li>Based on aggregated data obtained with <code>F03_prep_permutation_tests.m</code>.</li>
</ul></li>
<li>Relevant time windows of the single trial EEG data, as determined using CBPT were then exported for single trial LMM analyses using <code>F05_export.m</code>.</li>
<li>ERP data were plotted using <code>F06_plotting.m</code>.
<ul>
<li><span style=" font-weight: bold;    color: #E8793A !important;">TO DO:</span> See if <code>R</code> can do a better job?</li>
</ul></li>
</ul>
</div>
<div id="froemeranalyses" class="section level3">
<h3><span class="header-section-number">1.3.3</span> Analyses</h3>
<ul>
<li>With <code>lme4</code>; <span class="math inline">\(p-\)</span>values with <code>lmerTest</code> (<span style=" font-weight: bold;    color: #6BBFA6 !important;">Satterthwaite approximation</span> for degrees of freedom):
<ul>
<li>Accuracy was analyzed with generalized linear mixed models (GLMMs), fitting a binomial model.</li>
<li>For the linear mixed models (LMM) analyses of reaction times (RTs) and ERPs, we further excluded trials with incorrect responses.</li>
</ul></li>
<li>Fixed effects structures of LMMs and GLMMs were <span style=" font-weight: bold;    color: #6BBFA6 !important;">reduced stepwise by excluding non-significant interaction terms/predictors</span> and compared using anova ratio tests until the respectively smaller model explained the data significantly worse than the larger model (significant X2-test).
<ul>
<li>That means: Manual inspection/decisions? See different steps in script <code>F00</code>.</li>
</ul></li>
<li>“We followed up the <span style=" font-weight: bold;    color: #E8793A !important;">significant interactions</span> by running <span style=" font-weight: bold;    color: #6BBFA6 !important;">additional models with the two factors nested within each other</span> to obtain the effects of one factor at each level of the other factor, respectively.”
<ul>
<li>“Note that for this procedure to be accurate, these models need to be specified identically to the original model except for the nesting.”</li>
<li>Another way shown in script: Obtain these with the <code>difflsmeans</code> function from the <code>lmerTest</code> package.</li>
</ul></li>
</ul>
<div id="for-brain-data" class="section level4">
<h4><span class="header-section-number">1.3.3.1</span> For brain data</h4>
<p><img src="pics/froemer_fig4.jpg" width="100%" /></p>
<ul>
<li><span style=" font-weight: bold;    color: #6BBFA6 !important;">CBPTs comparing mean amplitudes</span> over the epoch 0 – 800 ms for blurred vs. intact stimulus conditions
<ul>
<li>Differences started around 100 ms after stimulus onset and remained throughout the whole epoch.</li>
<li>Three clusters:
<ul>
<li>From 116 ms on, the blurred condition evoked more positive amplitudes at central, parietal and frontocentral electrode sites (p = 0.002).</li>
<li>Between 124 and 594 ms, the blurred condition evoked lower amplitudes at parietal and occipital electrodes (p = 0.002).</li>
<li>Between 640 and 800 ms, the blurred condition evoked lower amplitudes at frontal and frontocentral electrodes (p = 0.008).</li>
</ul></li>
</ul></li>
<li>“<span style=" font-weight: bold;    color: #E8793A !important;">Here we limit the follow-up analyses</span> to the fronto-central N2 between 250 and 350ms (FC1, FC2, C1, Cz, C2), as well as the centro-parietal P3b/CPP (CP3, CP1, CPz, CP2, CP4, P3, Pz, P4, PO3, POz, PO4) between 400 and 550 ms.”
<ul>
<li>That means: Rather arbitrary decision that is not guided roughly, but not all <em>too</em> much by CBPT results (and partly by literature).</li>
</ul></li>
</ul>
</div>
<div id="brain-data-predicting-behaviour" class="section level4">
<h4><span class="header-section-number">1.3.3.2</span> Brain data predicting behaviour</h4>
<ul>
<li>Centered amplitudes for N2 and P3b as predictors for behaviour.
<ul>
<li><span style=" font-weight: bold;    color: #E8793A !important;">Open question:</span> That is: Mean amplitude for specified time window?</li>
<li>“For these analyses, we divided all single trial amplitudes by 10, as <code>lme4</code> suggested rescaling of the variables to support model identifiability. Thus, the estimates from these analyses relate to amplitude changes of <span class="math inline">\(10 \mu V\)</span>.”
<ul>
<li><span style=" font-weight: bold;    color: #E8793A !important;">TO DO:</span> How to scale variables properly?</li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="fixed-effects" class="section level4">
<h4><span class="header-section-number">1.3.3.3</span> Fixed Effects</h4>
<ul>
<li>Perceptual uncertainty (blurred or not)</li>
<li>Position (left or right)</li>
</ul>
</div>
<div id="random-effects" class="section level4">
<h4><span class="header-section-number">1.3.3.4</span> Random Effects</h4>
<ul>
<li><p>Random Intercepts for:</p>
<ul>
<li>Participants (variance in individual means across all conditions, e.g., variance in average response time or ERP magnitude)</li>
<li>Object pairs (variance in means across stimuli, e.g., variance in average response times across stimuli)</li>
</ul></li>
<li><p>Random Slopes for the predictors (estimates the variance in the effect of a given manipulation across individuals or items):</p>
<ul>
<li>Perceptual uncertainty</li>
<li>Position</li>
</ul></li>
<li><p><span style=" font-weight: bold;    color: #6BBFA6 !important;">Random effects not supported by the data</span> (explaining zero variance according to singular value decomposition) were excluded to prevent overparameterization</p></li>
<li><p>For all predictors we applied <span style=" font-weight: bold;    color: #6BBFA6 !important;">sliding difference contrasts</span>, thus the resulting estimates can be interpreted as the difference between subsequent factor levels (level 2 minus level 1, e.g., intact minus blurred).</p>
<ul>
<li>The advantage of this contrast is that the fixed effect intercept (group-level mean) is estimated as the grand average across all conditions (e.g., the empirical group-level mean), rather than the mean of a baseline condition, as for example for the default treatment contrast, which can cause troubles when using multiple predictors.</li>
</ul></li>
</ul>
</div>
</div>
<div id="model" class="section level3">
<h3><span class="header-section-number">1.3.4</span> Model</h3>
<p>These are simplified versions of their models (various exlusion criteria are included for a1 in their versions) for reaction times. The same logic applies to accuracy, only with <code>glmer</code> (<span style=" font-weight: bold;    color: #E8793A !important;">To do:</span> Have a close look at the differences or rather, when to use what.). I only included the code for reaction times as an example of the general procedure.</p>
<p><span style=" font-weight: bold;    color: #E8793A !important;">Open question:</span> Does this notation imply that there is no random slope for the interaction of the fixed effects (<code>n_b</code> = blurred or not; <code>DeviantPosRL</code> = left or right)? Is that even possible?</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lmer</span>(RT <span class="op">~</span><span class="st"> </span>n_b <span class="op">*</span><span class="st"> </span>DeviantPosRL <span class="op">+</span><span class="st"> </span>(n_b <span class="op">+</span><span class="st"> </span>DeviantPosRL<span class="op">|</span>vpn) <span class="op">+</span><span class="st"> </span>
<span class="st">       </span>(n_b <span class="op">+</span><span class="st"> </span>DeviantPosRL<span class="op">|</span>Objektpaar), 
     <span class="dt">data =</span> a1,
     <span class="dt">REML =</span> <span class="ot">FALSE</span>)</code></pre>
<p>Then, they use these models to get the interactions. <span style=" font-weight: bold;    color: #E8793A !important;">See</span> <a href="fromer-et-al-2018.html#froemeranalyses">analyses</a> for specification.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># deviant position within perceptual certainty</span>
<span class="kw">lmer</span>(RT <span class="op">~</span><span class="st"> </span>n_b<span class="op">/</span>DeviantPosRL <span class="op">+</span><span class="st"> </span>(n_b <span class="op">+</span><span class="st"> </span>DeviantPosRL<span class="op">|</span>vpn) <span class="op">+</span><span class="st"> </span>
<span class="st">       </span>(n_b <span class="op">+</span><span class="st"> </span>DeviantPosRL<span class="op">|</span>Objektpaar), 
     <span class="dt">data =</span> a1, 
     <span class="dt">REML =</span> <span class="ot">FALSE</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># perceptual certainty within deviant position</span>
<span class="kw">lmer</span>(RT <span class="op">~</span><span class="st"> </span>DeviantPosRL<span class="op">/</span>n_b <span class="op">+</span><span class="st"> </span>(n_b <span class="op">+</span><span class="st"> </span>DeviantPosRL<span class="op">|</span>vpn) <span class="op">+</span><span class="st"> </span>
<span class="st">       </span>(n_b <span class="op">+</span><span class="st"> </span>DeviantPosRL<span class="op">|</span>Objektpaar), 
     <span class="dt">data =</span> a1, 
     <span class="dt">REML =</span> <span class="ot">FALSE</span>)</code></pre>
<p>Later, these models are reduced to the following forms. <span style=" font-weight: bold;    color: #E8793A !important;">To do:</span> Check how and why.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lmer</span>(RT <span class="op">~</span><span class="st"> </span>n_b <span class="op">*</span><span class="st"> </span>DeviantPosRL <span class="op">+</span><span class="st"> </span>(n_b <span class="op">+</span><span class="st"> </span>DeviantPosRL<span class="op">|</span>vpn), 
     <span class="dt">data =</span> a1, 
     <span class="dt">REML =</span> <span class="ot">FALSE</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lmer</span>(RT <span class="op">~</span><span class="st"> </span>n_b <span class="op">*</span><span class="st"> </span>DeviantPosRL <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>vpn), 
     <span class="dt">data =</span> a1, 
     <span class="dt">REML =</span> <span class="ot">FALSE</span>)</code></pre>
</div>
<div id="brain-stuff" class="section level3">
<h3><span class="header-section-number">1.3.5</span> Brain Stuff</h3>
<p>ERP data is taken from Matlab and then, the same logic is applied to e.g. the N2 values (<span style=" font-weight: bold;    color: #E8793A !important;">To do:</span> Check what is represented here - mean? Peak? Time windows?). <span style=" font-weight: bold;    color: #6BBFA6 !important;">Regarding our goal to model random effects for items:</span> “Note, random slope by item was omitted due to zero variance explained by that component.”</p>
<p>They then include scaled (centered) N2 and P3 fixed effects in their model with accuracy (and later reaction time) as outcome, which looks something like this:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lmer</span>(accuracy <span class="op">~</span><span class="st"> </span>n_b <span class="op">*</span><span class="st"> </span>DeviantPosRL <span class="op">*</span><span class="st"> </span>(scN2) <span class="op">*</span><span class="st"> </span>scP3 <span class="op">+</span><span class="st"> </span>(n_b <span class="op">+</span><span class="st"> </span>DeviantPosRL<span class="op">|</span>vpn) <span class="op">+</span><span class="st"> </span>
<span class="st">       </span>(n_b <span class="op">+</span><span class="st"> </span>DeviantPosRL<span class="op">|</span>Objektpaar), 
     <span class="dt">data =</span> a1, 
     <span class="dt">family =</span> binomial)</code></pre>
<p>They try some different versions with various interactions and compare the models to each other with ANOVAs. <span style=" font-weight: bold;    color: #E8793A !important;">To do:</span> Get clear what we want to look at and why.</p>
</div>
</div>
<div id="behavioural-results" class="section level2">
<h2><span class="header-section-number">1.4</span> Behavioural Results</h2>
<ul>
<li>For hit rates: main effects of pecerptual certainty and position.
<ul>
<li>And an interaction.</li>
</ul></li>
<li>For RT: main effect of perceptual certainty, but <span style=" font-weight: bold;    color: #6BBFA6 !important;">position n.s.</span> (see comparison below).
<ul>
<li>And an interaction.</li>
</ul></li>
<li>Following up on interactions:
<ul>
<li>Accuracy
<ul>
<li>Effect of position for blurred, but not intact stimuli.</li>
<li>Effect of perceptual certainty for both positions.</li>
</ul></li>
<li>RT
<ul>
<li>No effect of postion for both blurred and intact stimuli.</li>
<li>Effect of perceptual certainty for both positions.</li>
</ul></li>
</ul></li>
</ul>
<div id="comparison-to-standard-anova-and-regression" class="section level3">
<h3><span class="header-section-number">1.4.1</span> Comparison to standard ANOVA and regression</h3>
<div id="on-rt-data" class="section level4">
<h4><span class="header-section-number">1.4.1.1</span> on RT data</h4>
<ul>
<li>ANOVA: only main effect of perceptual certainty.</li>
<li>Regression: main effects of perceptual certainty and position.
<ul>
<li><span style=" font-weight: bold;    color: #E8793A !important;">Open question:</span> In mixed model, there was no main effect of position. Naturally, estimates of effects stay the same in mixed model vs. regression (they do stay roughly the same; <a href="https://osf.io/uycsd/">see commented out results in their analysis script</a>), but the standard error changes and hence, the significance of the effect.</li>
<li>They compare the original LLM with
<ul>
<li><ol style="list-style-type: lower-alpha">
<li>one omitting the random effects for items</li>
</ol></li>
<li><ol start="2" style="list-style-type: lower-alpha">
<li>one with random intercepts for participants only (without random effects)</li>
</ol></li>
</ul></li>
<li><span class="math inline">\(\to\)</span> The standard error of the effect for position drops across these models.</li>
</ul></li>
<li>They say: “[T]he LMM was more sensitive than the ANOVA and more specific than the ordinary regression.”
<ul>
<li>Probably because the LMM picked up an interaction and the ANOVA didn’t.</li>
<li>Probably because the regression picked up a main effect of position where the LLM found none.
<ul>
<li>However, the regression also missed the interaction effect.</li>
</ul></li>
</ul></li>
<li>Better model fit for LMM than for regression (obviously).</li>
</ul>
</div>
<div id="on-accuracy-data" class="section level4">
<h4><span class="header-section-number">1.4.1.2</span> On accuracy data</h4>
<ul>
<li>ANOVA not appropriate, but logistic regression.</li>
<li>Same results with regards to significant effects.</li>
<li>But: Underestimation of standard errors.</li>
<li>Better model fit for GLMM than for regression (obviously).</li>
</ul>
</div>
</div>
</div>
<div id="brain-results-n2" class="section level2">
<h2><span class="header-section-number">1.5</span> Brain Results N2</h2>
<ul>
<li><p>“The model estimates are summarized in Table 3 and can be read out directly as mean differences in <span class="math inline">\(\mu V\)</span> (<span style=" font-weight: bold;    color: #E8793A !important;">Note:</span> Should be due to sliding differences.) for main effects. Note that the N2 is a negative component; so negative estimates correspond to an increase in amplitude and positive estimates to a decrease in amplitude.”</p></li>
<li><p>Main effect of perceptual certainty: Reduced N2 for blurred vs. intact.</p></li>
<li><p>Main effect of position: Reduced N2 for right vs. left stimuli.</p></li>
<li><p>And an interaction.</p>
<ul>
<li>Significant effect of perceptual certainty for right and left position.</li>
<li>Position effect for intact but not for blurred stimuli.</li>
</ul></li>
<li><p>Comparison to ANOVA and regression: Same results, but better fit for LMM.</p></li>
</ul>
</div>
<div id="brain-results-p3b" class="section level2">
<h2><span class="header-section-number">1.6</span> Brain Results P3b</h2>
<ul>
<li>Main effect of perceptual certainty: Reduced P3b for blurred vs. intact stimuli.</li>
<li>No main effect of/interaction with position.
<ul>
<li>Stepwise model reduction: First, interaction excluded. Then: Position excluded altogether.</li>
<li>However: Random slope per participant for position still included, because removing it significantly decreased model fit.</li>
<li><span style=" font-weight: bold;    color: #E8793A !important;">Open question:</span> Is that possible/wise? How do you interpret the random effect without a main effect? Because the standard deviation of the effect is pretty meaningless when you don’t know the effect?</li>
<li><span style=" font-weight: bold;    color: #E8793A !important;">Author interpretation:</span> "[…] while there is no group level effect of deviant position, there are reliable individual differences in this effect, which might reflect differences in the use of top-down information for decision-making.</li>
</ul></li>
<li>Comparison to ANOVA and regression: Same results, but better fit for LMM.</li>
</ul>
</div>
<div id="results-brain-behaviour-relationship" class="section level2">
<h2><span class="header-section-number">1.7</span> Results Brain Behaviour Relationship</h2>
<ul>
<li><p>Centered amplitudes of N2 and P3b as predictors for behaviour.</p>
<ul>
<li><span style=" font-weight: bold;    color: #E8793A !important;">See</span> <a href="fromer-et-al-2018.html#froemeranalyses">analyses</a> for details/open questions.</li>
</ul></li>
<li><p>No 4- or 3-way-interactions, no interactions of perceptual certainty with position or N2 <span class="math inline">\(\to\)</span> excluded from the model. (There’s still an awful lot of stuff left in this model.)</p>
<ul>
<li>Fit not significantly worse; fit indices even smaller (= better fit).</li>
</ul></li>
<li><p>No main effect of N2 on accuracy, but interaction N2 <span class="math inline">\(\times\)</span> position.</p>
<ul>
<li>For left position: Larger N2 amplitudes related to higher detection likelihood.</li>
<li>For right position: No effect; descriptively if anything smaller amplitudes.#</li>
</ul></li>
<li><p>Accuracy increased with increasing P3b amplitude.</p></li>
<li><p>P3b <span class="math inline">\(\times\)</span> perception certainty: P3b effects on blurred and intact.</p></li>
<li><p>P3b <span class="math inline">\(\times\)</span> position: P3b effects on left and right.</p></li>
<li><p>N2 <span class="math inline">\(\times\)</span> P3b: Accuracy increased more strongly with P3b when N2 was smaller.</p></li>
<li><p>Comparison with logistic regression: Similar results, but no interaction between P3b and perceptual certainty.</p></li>
<li><p>Better fit for GLMM.</p></li>
<li><p>“We ran additional GLMMs, sequentially omitting random effects per item and random slopes, to see what produces the difference between the two methods. <span style=" font-weight: bold;    color: #6BBFA6 !important;">The estimate decreased when omitting the crossed random structure</span> and was no longer significant in the model with random intercept per participants only. Thus this effect was revealed when controlling for variance in effects across participants.”</p>
<ul>
<li><span style=" font-weight: bold;    color: #E8793A !important;">Open question:</span> What estimate are they referring to? How can a fixed effect (?) decrease when omitting random effects? It cannot be the estimate of the standard error, because then the effect would rather be significant instead of no longer being significant?</li>
</ul></li>
</ul>
</div>
<div id="to-do" class="section level2">
<h2><span class="header-section-number">1.8</span> TO DO</h2>
<ul>
<li>Get their data and see if I can reproduce the analyses.
<ul>
<li>Maybe with preprocessing in BrainVision Analyzer instead of Matlab?</li>
<li>Apply modified procedure to Laura’s data.</li>
</ul></li>
</ul>
</div>
</div>
            </section>

          </div>
        </div>
      </div>

<a href="smith-and-kutas-2015a.html" class="navigation navigation-next navigation-unique" aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": 3,
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
