<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Smith and Kutas 2015a | Single-Trial EEG Analysis</title>
  <meta name="description" content="3 Smith and Kutas 2015a | Single-Trial EEG Analysis" />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Smith and Kutas 2015a | Single-Trial EEG Analysis" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Smith and Kutas 2015a | Single-Trial EEG Analysis" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="fromer-et-al-2018.html">
<link rel="next" href="smith-and-kutas-2015b.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="general-stuff.html"><a href="general-stuff.html"><i class="fa fa-check"></i><b>1</b> General stuff</a><ul>
<li class="chapter" data-level="1.1" data-path="general-stuff.html"><a href="general-stuff.html#comparison-of-methods"><i class="fa fa-check"></i><b>1.1</b> Comparison of Methods</a><ul>
<li class="chapter" data-level="1.1.1" data-path="general-stuff.html"><a href="general-stuff.html#averaging-limitations"><i class="fa fa-check"></i><b>1.1.1</b> Averaging limitations</a></li>
<li class="chapter" data-level="1.1.2" data-path="general-stuff.html"><a href="general-stuff.html#some-alternatives"><i class="fa fa-check"></i><b>1.1.2</b> Some alternatives</a></li>
<li class="chapter" data-level="1.1.3" data-path="general-stuff.html"><a href="general-stuff.html#advantages-of-mixed-models"><i class="fa fa-check"></i><b>1.1.3</b> Advantages of mixed models</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="general-stuff.html"><a href="general-stuff.html#determining-time-windows"><i class="fa fa-check"></i><b>1.2</b> Determining Time Windows</a></li>
<li class="chapter" data-level="1.3" data-path="general-stuff.html"><a href="general-stuff.html#limitations"><i class="fa fa-check"></i><b>1.3</b> Limitations</a></li>
<li class="chapter" data-level="1.4" data-path="general-stuff.html"><a href="general-stuff.html#conclusion"><i class="fa fa-check"></i><b>1.4</b> Conclusion</a></li>
<li class="chapter" data-level="1.5" data-path="general-stuff.html"><a href="general-stuff.html#to-do"><i class="fa fa-check"></i><b>1.5</b> TO DO</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html"><i class="fa fa-check"></i><b>2</b> Frömer et al. (2018)</a><ul>
<li class="chapter" data-level="2.1" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#cookbook"><i class="fa fa-check"></i><b>2.1</b> Cookbook</a><ul>
<li class="chapter" data-level="2.1.1" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#example-task"><i class="fa fa-check"></i><b>2.1.1</b> Example Task</a></li>
<li class="chapter" data-level="2.1.2" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#scripts"><i class="fa fa-check"></i><b>2.1.2</b> Scripts</a></li>
<li class="chapter" data-level="2.1.3" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#froemeranalyses"><i class="fa fa-check"></i><b>2.1.3</b> Analyses</a></li>
<li class="chapter" data-level="2.1.4" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#model"><i class="fa fa-check"></i><b>2.1.4</b> Model</a></li>
<li class="chapter" data-level="2.1.5" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#brain-stuff"><i class="fa fa-check"></i><b>2.1.5</b> Brain Stuff</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#behavioural-results"><i class="fa fa-check"></i><b>2.2</b> Behavioural Results</a><ul>
<li class="chapter" data-level="2.2.1" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#comparison-to-standard-anova-and-regression"><i class="fa fa-check"></i><b>2.2.1</b> Comparison to standard ANOVA and regression</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#brain-results-n2"><i class="fa fa-check"></i><b>2.3</b> Brain Results N2</a></li>
<li class="chapter" data-level="2.4" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#brain-results-p3b"><i class="fa fa-check"></i><b>2.4</b> Brain Results P3b</a></li>
<li class="chapter" data-level="2.5" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#results-brain-behaviour-relationship-accuracy"><i class="fa fa-check"></i><b>2.5</b> Results Brain Behaviour Relationship Accuracy</a></li>
<li class="chapter" data-level="2.6" data-path="fromer-et-al-2018.html"><a href="fromer-et-al-2018.html#results-brain-behaviour-relationship-rt"><i class="fa fa-check"></i><b>2.6</b> Results Brain Behaviour Relationship RT</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="smith-and-kutas-2015a.html"><a href="smith-and-kutas-2015a.html"><i class="fa fa-check"></i><b>3</b> Smith and Kutas 2015a</a><ul>
<li class="chapter" data-level="3.1" data-path="smith-and-kutas-2015a.html"><a href="smith-and-kutas-2015a.html#a-regression-based-framework-for-estimating-erps-rerp"><i class="fa fa-check"></i><b>3.1</b> A Regression-Based Framework for Estimating ERPs (rERP)</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="smith-and-kutas-2015b.html"><a href="smith-and-kutas-2015b.html"><i class="fa fa-check"></i><b>4</b> Smith and Kutas 2015b</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Single-Trial EEG Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="smith-and-kutas-2015a" class="section level1">
<h1><span class="header-section-number">3</span> Smith and Kutas 2015a</h1>
<p><a href="https://www.ncbi.nlm.nih.gov/pubmed/25141770">Smith</a> <span class="citation">(2015a)</span>. <strong>Regression-based estimation of ERP waveforms: I. The rERP framework.</strong></p>
<p>ERP averaging is an extraordinarily successful method, but can only be applied to a limited range of experimental designs. We introduce the regression-based rERP framework, which extends ERP averaging to handle arbitrary combinations of categorical and continuous covariates, partial confounding, non-linear effects, and overlapping responses to distinct events, all within a single unified system. rERPs enable a richer variety of paradigms (including high-N naturalistic designs) while preserving the advantages of traditional ERPs.</p>
<p>This article provides an accessible introduction to what rERPs are, why they are useful, how they are computed, and when we should expect them to be effective, particularly in cases of partial confounding. A companion article discusses how non-linear effects and overlap correction can be handled within this framework, as well as practical considerations around baselining, filtering, statistical testing, and artifact rejection. Free software implementing these techniques is available.</p>
<div id="a-regression-based-framework-for-estimating-erps-rerp" class="section level2">
<h2><span class="header-section-number">3.1</span> A Regression-Based Framework for Estimating ERPs (rERP)</h2>
<ul>
<li>Single method for estimating ERP waveforms.
<ul>
<li>Factorial or continuousd design or both.</li>
<li>Orthogonal or partially confounded design.</li>
<li>Linear or non-linear effects of continuous covariates.</li>
<li>Overlapping ERPs produced by events of interest or not.</li>
</ul></li>
<li>In the simplest case – a categorical design with no overlap correction – rERP estimates are mathematically identical to those produced by traditional averaging.</li>
</ul>
<p>Instead of trying to estimate the whole waveform at once, we start by working out how to estimate the value of the ERP at one single electrode and latency – e.g., 136 ms post-event at electrode Cz. (if we can do this, then we can estimate the rest of the ERP by just repeating our technique at every electrode and latency.) Estimate for every trial:</p>
<p><span class="math display">\[
y_i =\beta + \textrm{noise}_i
\]</span></p>
<ul>
<li>At every trial, the noise will be different, but the value of the ERP (at this latency and electrode) will be the same.</li>
<li>Usual suggestion to estimate <span class="math inline">\(\beta\)</span>: Take the average of <span class="math inline">\(y_i\)</span>.</li>
<li>If we knew the noise at every trial or the estimate for <span class="math inline">\(\beta\)</span>, we could solve the equations, but we don’t know neither.</li>
</ul>
<p>What we can use instead: The principle of <span style=" font-weight: bold;    color: #E8793A !important;">least squares</span>: We should choose our estimate of <span class="math inline">\(\beta\)</span> to be the number which makes our estimate for the total squared noise,</p>
<p><span class="math display">\[
\textrm{squared noise} =\sum_{i=1}^{n}\left(\textrm{noise }_{i}\right)^{2}=\sum_{i=1}^{n}\left(y_{i}-\beta\right)^{2}
\]</span></p>
<p>as small als possible. So we take the <span style=" font-weight: bold;    color: #E8793A !important;">derivate</span> of this formula:</p>
<p><span class="math display">\[
\frac{d}{d \beta} \textrm{ squared noise }=\frac{d}{d \beta} \sum_{i=1}^{n}\left(y_{i}-\beta\right)^{2}=\sum_{i=1}^{n}-2\left(y_{i}-\beta\right)
\]</span></p>
<p>And then set it equal to zero:</p>
<p><span class="math display">\[
\sum_{i=1}^{n}-2\left(y_{i}-\beta\right)=0
\]</span></p>
<p>And solve for <span class="math inline">\(\beta\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}-2\left(\sum_{i=1}^{n} y_{i}-\sum_{i=1}^{n} \beta\right) &amp;=0 \\ \sum_{i=1}^{n} y_{i} &amp;=\sum_{i=1}^{n} \beta \\ \sum_{i=1}^{n} y_{i} &amp;=n \beta \\ \frac{1}{n} \sum_{i=1}^{n} y_{i} &amp;=\beta \end{aligned}
\]</span></p>
<p><span style=" font-weight: bold;    color: #6BBFA6 !important;">Notice that this final formula turns out to be the standard formula for calculating the mean.</span> This means that according to the least-squares principle, the best way to estimate <span class="math inline">\(\beta\)</span> is to take the average of our measured values, <span class="math inline">\(y_i, ..., y_n\)</span>. This is the reason why using averaging to estimate ERPs makes sense in the first place.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="fromer-et-al-2018.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="smith-and-kutas-2015b.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": 3,
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
