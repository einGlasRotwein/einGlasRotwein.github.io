<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Random intercept models | Mixed Models</title>
  <meta name="description" content="4 Random intercept models | Mixed Models" />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Random intercept models | Mixed Models" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Random intercept models | Mixed Models" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="3-exkurs-regressionen.html">
<link rel="next" href="5-randomslopes.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="1-first-things-first.html"><a href="1-first-things-first.html"><i class="fa fa-check"></i><b>1</b> First Things First</a></li>
<li class="chapter" data-level="2" data-path="2-mixed-models.html"><a href="2-mixed-models.html"><i class="fa fa-check"></i><b>2</b> Mixed Models</a><ul>
<li class="chapter" data-level="2.1" data-path="2-mixed-models.html"><a href="2-mixed-models.html#uberblick"><i class="fa fa-check"></i><b>2.1</b> Überblick</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-exkurs-regressionen.html"><a href="3-exkurs-regressionen.html"><i class="fa fa-check"></i><b>3</b> Exkurs Regressionen</a><ul>
<li class="chapter" data-level="3.1" data-path="3-exkurs-regressionen.html"><a href="3-exkurs-regressionen.html#averaging-ist-eine-least-squares-regression"><i class="fa fa-check"></i><b>3.1</b> Averaging ist eine Least-Squares Regression</a></li>
<li class="chapter" data-level="3.2" data-path="3-exkurs-regressionen.html"><a href="3-exkurs-regressionen.html#von-averaging-zur-regression"><i class="fa fa-check"></i><b>3.2</b> Von Averaging zur Regression</a></li>
<li class="chapter" data-level="3.3" data-path="3-exkurs-regressionen.html"><a href="3-exkurs-regressionen.html#pradiktoren-definieren"><i class="fa fa-check"></i><b>3.3</b> Prädiktoren definieren</a></li>
<li class="chapter" data-level="3.4" data-path="3-exkurs-regressionen.html"><a href="3-exkurs-regressionen.html#kollinearitat"><i class="fa fa-check"></i><b>3.4</b> Kollinearität</a></li>
<li class="chapter" data-level="3.5" data-path="3-exkurs-regressionen.html"><a href="3-exkurs-regressionen.html#codinginr"><i class="fa fa-check"></i><b>3.5</b> Variablenkodierung in R</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-random-intercept-models.html"><a href="4-random-intercept-models.html"><i class="fa fa-check"></i><b>4</b> Random intercept models</a><ul>
<li class="chapter" data-level="4.1" data-path="4-random-intercept-models.html"><a href="4-random-intercept-models.html#generelle-logik"><i class="fa fa-check"></i><b>4.1</b> Generelle Logik</a></li>
<li class="chapter" data-level="4.2" data-path="4-random-intercept-models.html"><a href="4-random-intercept-models.html#in-r"><i class="fa fa-check"></i><b>4.2</b> in R</a></li>
<li class="chapter" data-level="4.3" data-path="4-random-intercept-models.html"><a href="4-random-intercept-models.html#simulationen"><i class="fa fa-check"></i><b>4.3</b> Simulationen</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-randomslopes.html"><a href="5-randomslopes.html"><i class="fa fa-check"></i><b>5</b> Random slope models</a><ul>
<li class="chapter" data-level="5.1" data-path="5-randomslopes.html"><a href="5-randomslopes.html#mixed-models-vs.-einzelne-regressionen"><i class="fa fa-check"></i><b>5.1</b> Mixed Models vs. einzelne Regressionen</a></li>
<li class="chapter" data-level="5.2" data-path="5-randomslopes.html"><a href="5-randomslopes.html#simulationen-1"><i class="fa fa-check"></i><b>5.2</b> Simulationen</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-logistische-regression.html"><a href="6-logistische-regression.html"><i class="fa fa-check"></i><b>6</b> Logistische Regression</a><ul>
<li class="chapter" data-level="6.1" data-path="6-logistische-regression.html"><a href="6-logistische-regression.html#die-logit-linkfunktion"><i class="fa fa-check"></i><b>6.1</b> Die Logit-Linkfunktion</a></li>
<li class="chapter" data-level="6.2" data-path="6-logistische-regression.html"><a href="6-logistische-regression.html#parameterschatzung"><i class="fa fa-check"></i><b>6.2</b> Parameterschätzung</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-interpretation-des-outcomes.html"><a href="7-interpretation-des-outcomes.html"><i class="fa fa-check"></i><b>7</b> Interpretation des Outcomes</a><ul>
<li class="chapter" data-level="7.1" data-path="7-interpretation-des-outcomes.html"><a href="7-interpretation-des-outcomes.html#odds-vs.-probabilty"><i class="fa fa-check"></i><b>7.1</b> Odds vs. Probabilty</a></li>
<li class="chapter" data-level="7.2" data-path="7-interpretation-des-outcomes.html"><a href="7-interpretation-des-outcomes.html#die-sache-mit-dem-log"><i class="fa fa-check"></i><b>7.2</b> Die Sache mit dem Log</a></li>
<li class="chapter" data-level="7.3" data-path="7-interpretation-des-outcomes.html"><a href="7-interpretation-des-outcomes.html#odd-ratios-als-effektgroen"><i class="fa fa-check"></i><b>7.3</b> Odd Ratios als Effektgrößen</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-logistische-regression-the-bayes-way.html"><a href="8-logistische-regression-the-bayes-way.html"><i class="fa fa-check"></i><b>8</b> Logistische Regression - the Bayes way</a></li>
<li class="chapter" data-level="9" data-path="9-multinomiale-logistische-regressionen.html"><a href="9-multinomiale-logistische-regressionen.html"><i class="fa fa-check"></i><b>9</b> Multinomiale logistische Regressionen</a></li>
<li class="chapter" data-level="" data-path="referenzen.html"><a href="referenzen.html"><i class="fa fa-check"></i>Referenzen</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Mixed Models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="random-intercept-models" class="section level1">
<h1><span class="header-section-number">4</span> Random intercept models</h1>
<div id="generelle-logik" class="section level2">
<h2><span class="header-section-number">4.1</span> Generelle Logik</h2>
<p>Studenten werden an verschiedenen Zeitpunkten (occasions) getestet (GPA). Zeitpunkte sind ein Haupteffekt. Individuelle Effekte der Studenten werden Modell hinzugefügt:</p>
<p><span class="math display">\[
\mathrm{gpa}=b_{\mathrm{intercept}}+b_{\mathrm{occ}} \cdot \text { occasion }+\left(\text {effect }_{\mathrm{student}}+\epsilon\right)
\]</span></p>
<ul>
<li>Der einzige Unterschied zwischen einem mixed model und einer standardmäßigen Regression: <span style=" font-weight: bold;    color: #6BBFA6 !important;">random student effect</span>
<ul>
<li>Normalverteilt mit <span class="math inline">\(M = 0\)</span> und irgendeiner geschätzten Standardabweichung <span class="math inline">\(\tau\)</span></li>
<li>Im Mittel kein Effekt, aber variiert von Student zu Student im Mittel um <span class="math inline">\(\tau\)</span></li>
</ul></li>
</ul>
<p><span class="math display">\[
\text{effect}_\text{student} \sim \mathscr { N } ( 0 , \tau )
\]</span></p>
<p>Jeder Student hat seinen eigenen Effekt, der zum allgemeinen intercept hinzugefügt wird. Das heißt, jeder Student hat sein eigenes intercept, mit anderen “Worten”:</p>
<p><span class="math display">\[
\mathrm{gpa}=b_{\mathrm{int} \text { student }}+b_{\mathrm{occ}} \cdot \text { occasion }+\epsilon
\]</span>
Das heißt: <span style=" font-weight: bold;    color: #E8793A !important;">Intercepts</span> sind jetzt normalverteilt. Das overall Intercept als Mittelwert mit irgendeiner SD <span class="math inline">\(\tau\)</span>.</p>
<p><span class="math display">\[
b_{\text { int } \text { student }} \sim \mathscr{N}\left(b_{\text { intercept }}, \tau\right)
\]</span></p>
<p>Wenn man die einzelnen Studenten plottet, sieht man gut, wieso es eine gute Idee ist, die Individualität pro Student zu berücksichtigen: Die Variablität in den Startpunkten und die Entwicklung über die Zeit ist ist hoch.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&quot;data/gpa.RData&quot;</span>)

<span class="co"># Random 10 Einzellinien highlighten</span>
gpa &lt;-<span class="st"> </span>gpa <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">highlight =</span> <span class="kw">ifelse</span>(student <span class="op">%in%</span><span class="st"> </span><span class="kw">sample</span>(<span class="kw">unique</span>(student), <span class="dv">10</span>), <span class="ot">TRUE</span>, <span class="ot">FALSE</span>))</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">gpa <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> occasion, <span class="dt">y =</span> gpa)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> student, <span class="dt">colour =</span> highlight, <span class="dt">alpha =</span> highlight, 
                <span class="dt">size =</span> highlight)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">colour =</span> farbschema[<span class="dv">1</span>], <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_alpha_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(.<span class="dv">1</span>, <span class="dv">1</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_size_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="dv">1</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">pick_colour</span>(<span class="dv">2</span>, <span class="st">&quot;mono_green&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Rohdaten&quot;</span>) <span class="op">+</span>
<span class="st">  </span>julis_theme <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))</code></pre>
<p><img src="01_1_first_things_first_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p><span class="math inline">\(\to\)</span> Siehe Skript uebungen.R – Übung #1 für einfache Regression.</p>
<div id="problem-einfache-regression" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Problem einfache Regression</h3>
<ul>
<li>Clustering wird ignoriert.
<ul>
<li>Man verpasst die (interessanten) Studenten-Effekte.</li>
<li>Die Standardfehler sind biased <span class="math inline">\(\to\)</span> Aussagen über statistische Signifikanz werden hinfällig</li>
</ul></li>
<li>Eine Regression pro Student
<ul>
<li>hätte zu wenig Daten.</li>
<li>“over-contextualised” <span class="math inline">\(\to\)</span> ignoriert, was die Studenten gemeinsam haben</li>
</ul></li>
</ul>
</div>
</div>
<div id="in-r" class="section level2">
<h2><span class="header-section-number">4.2</span> in R</h2>
<p>Notation, um das Intercept <code>1</code> pro Student variieren zu lassen: <code>(1|student)</code>. Ich benutze broom bzw. broom.mixed, um die Modelle aufgeräumt darzustellen. Im Code verwendet er summary, aber das ist da eher ein Krampf. Interessanterweise räumt er selbst seine Tabellen vor der Darstellung auch auf. Vermutlich per Hand.</p>
<p><span class="math inline">\(\to\)</span> Siehe Skript uebungen.R – Übung #2 für mixed Model.</p>
<pre class="sourceCode r"><code class="sourceCode r">gpa_mixed &lt;-<span class="st"> </span><span class="kw">lmer</span>(gpa <span class="op">~</span><span class="st"> </span>occasion <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>student), <span class="dt">data =</span> gpa)

gpa_mixed_coef &lt;-<span class="st"> </span><span class="kw">tidy</span>(gpa_mixed)
gpa_mixed_fit &lt;-<span class="st"> </span><span class="kw">glance</span>(gpa_mixed)</code></pre>
<div id="vergleich-einfache-regression-vs.-mixed-model" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Vergleich einfache Regression vs. mixed model</h3>
<p>Mixed model hat keine p-values im Output - auch nicht mit <code>summary</code>.</p>
<p>Interessant hierzu in mitgeliefertem Notebook <code>mixed_models_basics.Rmd</code>: “People always ask where the <span class="math inline">\(p\)</span>-values are, but the answer is… complicated. Other packages and programs present them as if they are trivially obtained, but that is not the case, and the <code>lme4</code> developers would rather not make unnecessary assumptions. On the plus side, you can get interval estimates easily enough, even though they are poorly named for the variance components. <code>sigma01</code> is the student variance.”</p>
<p>Später schreibt er dazu, dass man in mixed models verschiedene Stichprobengrößen von Cluster zu Cluster hat, sowie das N der Gesamtstichprobe. Was es schwierig macht, eine Referenzverteilung zu bestimmen, bzgl. Freiheitsgrade und so.</p>
<p>Das Paket <code>lmerTest</code> bietet allerdings Möglichkeiten, um <span class="math inline">\(p\)</span>-Werte auszuspucken und wird scheinbar auch von den <code>lme4</code>-Leuten empfohlen bzw. ist in der Literatur etabliert. Siehe Manual <a href="https://cran.r-project.org/web/packages/lmerTest/index.html">hier</a>.</p>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-14">Table 4.1: </span>std. regression
</caption>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:left;">
estimate
</th>
<th style="text-align:left;">
std.error
</th>
<th style="text-align:left;">
statistic
</th>
<th style="text-align:left;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:left;">
2.599
</td>
<td style="text-align:left;">
0.018
</td>
<td style="text-align:left;">
145.651
</td>
<td style="text-align:left;">
p &lt; .001
</td>
</tr>
<tr>
<td style="text-align:left;">
occasion
</td>
<td style="text-align:left;">
0.106
</td>
<td style="text-align:left;">
0.006
</td>
<td style="text-align:left;">
18.037
</td>
<td style="text-align:left;">
p &lt; .001
</td>
</tr>
</tbody>
</table>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-15">Table 4.2: </span>mixed model
</caption>
<thead>
<tr>
<th style="text-align:left;">
effect
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
term
</th>
<th style="text-align:left;">
estimate
</th>
<th style="text-align:left;">
std.error
</th>
<th style="text-align:left;">
statistic
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:left;">
2.599
</td>
<td style="text-align:left;">
0.022
</td>
<td style="text-align:left;">
119.800
</td>
</tr>
<tr>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
occasion
</td>
<td style="text-align:left;">
0.106
</td>
<td style="text-align:left;">
0.004
</td>
<td style="text-align:left;">
26.096
</td>
</tr>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
student
</td>
<td style="text-align:left;">
sd__(Intercept)
</td>
<td style="text-align:left;">
0.252
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
Residual
</td>
<td style="text-align:left;">
sd__Observation
</td>
<td style="text-align:left;">
0.241
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
</tbody>
</table>
<ul>
<li>Koeffizienten der fixed effects sind dieselben wie in der normalen Regression!
<ul>
<li>Ist nicht immer der Fall, z.B. bei unbalancierten Daten - aber sollte wohl meistens dicht dran sein.</li>
<li>Hier: Studenten starten mit einem GPA von 2.6 und jedes Semester kommen .11 Punkte dazu.</li>
</ul></li>
<li><span style=" font-weight: bold;    color: #6BBFA6 !important;">Standardfehler</span> unterscheiden sich; der fürs Intercept ist gestiegen, der für den Messzeitpunkt ist runter gegangen.
<ul>
<li>Wir haben mehr Infos über das Individuum und drücken gleichzeitig gesteigerte Unsicherheit über Average (Intercept) aus.</li>
</ul></li>
<li><span style=" font-weight: bold;    color: #E8793A !important;">Ganz interessant</span> (wenn auch eher eine vorsichtige offene Frage): Siehe <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5810264/">Frömer et al. (2018)</a> p. 7 vs. p. 11. Offenbar ist es möglich, dass fixed Effects mal signifikant werden und mal nicht, je nachdem, ob random Effects mit eingeschlossen sind oder nicht. Der Standardfehler kann durch die Hinzunahme von random Effects sowohl sinken als auch steigen (siehe oben: Intercept vs. Messzeitpunkteffekt). Im Paper ist aber auf p. 11 die Rede von einem sinkenden Estimate - es ist nicht ganz klar, auf was es sich bezieht; offenbar auf den Effekt selbst. Dessen Schätzung sollte ja eigentlich unbeeinflusst sein von den random Effects.</li>
</ul>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-16">Table 4.3: </span>Std. Regression
</caption>
<thead>
<tr>
<th style="text-align:left;">
r.squared
</th>
<th style="text-align:left;">
adj.r.squared
</th>
<th style="text-align:left;">
sigma
</th>
<th style="text-align:left;">
statistic
</th>
<th style="text-align:left;">
p.value
</th>
<th style="text-align:left;">
df
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0.21
</td>
<td style="text-align:left;">
0.21
</td>
<td style="text-align:left;">
0.35
</td>
<td style="text-align:left;">
325.34
</td>
<td style="text-align:left;">
0.00
</td>
<td style="text-align:left;">
2.00
</td>
</tr>
</tbody>
</table>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-17">Table 4.4: </span>Std. Regression
</caption>
<thead>
<tr>
<th style="text-align:left;">
logLik
</th>
<th style="text-align:left;">
AIC
</th>
<th style="text-align:left;">
BIC
</th>
<th style="text-align:left;">
deviance
</th>
<th style="text-align:left;">
df.residual
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
-437.49
</td>
<td style="text-align:left;">
880.98
</td>
<td style="text-align:left;">
896.25
</td>
<td style="text-align:left;">
145.67
</td>
<td style="text-align:left;">
1198.00
</td>
</tr>
</tbody>
</table>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-18">Table 4.5: </span>Mixed Model
</caption>
<thead>
<tr>
<th style="text-align:left;">
sigma
</th>
<th style="text-align:left;">
logLik
</th>
<th style="text-align:left;">
AIC
</th>
<th style="text-align:left;">
BIC
</th>
<th style="text-align:left;">
REMLcrit
</th>
<th style="text-align:left;">
df.residual
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0.24
</td>
<td style="text-align:left;">
-204.45
</td>
<td style="text-align:left;">
416.89
</td>
<td style="text-align:left;">
437.25
</td>
<td style="text-align:left;">
408.89
</td>
<td style="text-align:left;">
1196.00
</td>
</tr>
</tbody>
</table>
<ul>
<li>Achtung, Verwirrung: Ich bekomme hier mit <code>broom</code> in beiden Fällen <span style=" font-weight: bold;    color: #E8793A !important;">sigma</span>, die <span style=" font-weight: bold;    color: #E8793A !important;">residual standard deviation</span>. Wenn ich die <code>summary</code>-Funktion auf das mixed model anwende, finde ich diesen Wert als <span style=" font-weight: bold;    color: #6BBFA6 !important;">residual standard deviation</span> in der Tabelle <span style=" font-weight: bold;    color: #6BBFA6 !important;">Random effects</span>. In <code>lm</code> heißt das aber <span style=" font-weight: bold;    color: #E8793A !important;">residual standard error</span> (in der Auflistung unterhalb der Tabelle). Das ist aber dasselbe und ist wohl nur falsch benannt! (siehe z.B. <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/sigma.html">hier</a>)
<ul>
<li>Beides ist jedenfalls inhaltlich dasselbe, aber die Werte unterscheiden sich: Die <span style=" font-weight: bold;    color: #6BBFA6 !important;">unaufgeklärte Varianz</span> wurde aufgeteilt.</li>
<li>Im mixed model findet man dieselbe Information auch noch mal in der Tabelle (3.2) in der Zeile <code>ran_pars - Residual - sd__Observation</code>, Spalte <code>estimate</code>.</li>
<li>Entsprechend gibt <code>estimate</code> in der Zeile darüber (<code>ran_pars - student - sd__(Intercept)</code>) die geschätzte Standardabweichung vom <span style=" font-weight: bold;    color: #E8793A !important;">fixed effect</span> an, mit anderen Worten: Wie sehr wir vom “normalen” (fixed) effect abweichen, wenn wir uns von Student zu Student bewegen (sprich: <span class="math inline">\(\tau\)</span> in der Formel oben).
<ul>
<li>Scores variieren von Student zu Student mehr als doppelt so viel wie von Semester zu Semester!</li>
</ul></li>
</ul></li>
</ul>
<p>Siehe hier abgefahrener Code, wie man nur diese Info ohne <code>broom</code> extrahiert:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">VarCorr</span>(gpa_mixed), <span class="dt">comp =</span> <span class="kw">c</span>(<span class="st">&quot;Var&quot;</span>, <span class="st">&quot;Std&quot;</span>)) </code></pre>
<pre><code>##  Groups   Name        Variance Std.Dev.
##  student  (Intercept) 0.063719 0.25243 
##  Residual             0.058089 0.24102</code></pre>
<p>Das können wir auch direkt nutzen (die Varianz steckt im Broom-Output nicht drin), um die Varianz, die durch die Studenten aufgeklärt wird in Bezug zur Gesamtvarianz zu setzen: <code>.064 / .064 + .058 =</code> 1.058. Genauer gesagt ist das das Verhältnis der Varianz between clusters zur Gesamtvarianz in <span class="math inline">\(y\)</span>. Das ist dann die <span style=" font-weight: bold;    color: #E8793A !important;">intraclass correlation</span>, weil das gleichzeitig auch ein Schätzer der Korrelation innerhalb eines Clusters ist.</p>
<div id="zugriff-auf-die-geschatzten-abweichungen-einzelner-individuen" class="section level4">
<h4><span class="header-section-number">4.2.1.1</span> Zugriff auf die geschätzten Abweichungen einzelner Individuen</h4>
<p>Hier wird also geschätzt, wie sehr jeder Student vom mittleren Intercept abweicht (im Mittel um 0!). Schätzungen bezeichnet man - höhö - als <span style=" font-weight: bold;    color: #6BBFA6 !important;">BLUPs oder EBLUPs</span> (= (empirical) best linear unbiased prediction). Im Workshop unter <a href="https://m-clark.github.io/mixed-models-with-R/random_intercepts.html#application"><span style=" font-weight: bold;    color: #397367 !important;">Application</span></a> <span class="math inline">\(\to\)</span> Estimates of the random effects findet sich auch Code, um geschätzte Intervalle für die Effekte via Bootstrapping zu finden und sehr schick zu plotten.</p>
<pre class="sourceCode r"><code class="sourceCode r">(random_effects &lt;-<span class="st"> </span><span class="kw">ranef</span>(gpa_mixed)<span class="op">$</span>student)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["(Intercept)"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"-0.070894965","_rn_":"1"},{"1":"-0.215578568","_rn_":"2"},{"1":"0.088256998","_rn_":"3"},{"1":"-0.186641848","_rn_":"4"},{"1":"0.030383557","_rn_":"5"},{"1":"-0.302388730","_rn_":"6"},{"1":"-0.143236767","_rn_":"7"},{"1":"0.218472240","_rn_":"8"},{"1":"0.102725358","_rn_":"9"},{"1":"0.015915196","_rn_":"10"},{"1":"0.363155843","_rn_":"11"},{"1":"0.001446836","_rn_":"12"},{"1":"0.522307806","_rn_":"13"},{"1":"0.117193718","_rn_":"14"},{"1":"-0.215578568","_rn_":"15"},{"1":"-0.128768407","_rn_":"16"},{"1":"-0.273452009","_rn_":"17"},{"1":"-0.302388730","_rn_":"18"},{"1":"-0.099831686","_rn_":"19"},{"1":"0.232940601","_rn_":"20"},{"1":"-0.302388730","_rn_":"21"},{"1":"0.117193718","_rn_":"22"},{"1":"0.073788637","_rn_":"23"},{"1":"0.001446836","_rn_":"24"},{"1":"0.392092564","_rn_":"25"},{"1":"-0.273452009","_rn_":"26"},{"1":"-0.374730531","_rn_":"27"},{"1":"0.117193718","_rn_":"28"},{"1":"0.102725358","_rn_":"29"},{"1":"0.218472240","_rn_":"30"},{"1":"-0.360262171","_rn_":"31"},{"1":"0.261877321","_rn_":"32"},{"1":"-0.128768407","_rn_":"33"},{"1":"-0.215578568","_rn_":"34"},{"1":"0.088256998","_rn_":"35"},{"1":"0.131662079","_rn_":"36"},{"1":"0.088256998","_rn_":"37"},{"1":"0.421029284","_rn_":"38"},{"1":"-0.056426605","_rn_":"39"},{"1":"0.276345682","_rn_":"40"},{"1":"0.522307806","_rn_":"41"},{"1":"-0.056426605","_rn_":"42"},{"1":"0.073788637","_rn_":"43"},{"1":"0.175067159","_rn_":"44"},{"1":"0.175067159","_rn_":"45"},{"1":"-0.287920370","_rn_":"46"},{"1":"-0.230046929","_rn_":"47"},{"1":"0.001446836","_rn_":"48"},{"1":"0.102725358","_rn_":"49"},{"1":"-0.070894965","_rn_":"50"},{"1":"-0.027489885","_rn_":"51"},{"1":"0.160598799","_rn_":"52"},{"1":"0.073788637","_rn_":"53"},{"1":"0.189535520","_rn_":"54"},{"1":"0.146130439","_rn_":"55"},{"1":"-0.258983649","_rn_":"56"},{"1":"0.073788637","_rn_":"57"},{"1":"-0.186641848","_rn_":"58"},{"1":"0.059320277","_rn_":"59"},{"1":"-0.157705127","_rn_":"60"},{"1":"0.261877321","_rn_":"61"},{"1":"-0.114300046","_rn_":"62"},{"1":"0.276345682","_rn_":"63"},{"1":"0.102725358","_rn_":"64"},{"1":"-0.244515289","_rn_":"65"},{"1":"0.204003880","_rn_":"66"},{"1":"-0.215578568","_rn_":"67"},{"1":"-0.273452009","_rn_":"68"},{"1":"-0.273452009","_rn_":"69"},{"1":"0.015915196","_rn_":"70"},{"1":"0.001446836","_rn_":"71"},{"1":"0.435497645","_rn_":"72"},{"1":"-0.215578568","_rn_":"73"},{"1":"0.218472240","_rn_":"74"},{"1":"0.030383557","_rn_":"75"},{"1":"0.160598799","_rn_":"76"},{"1":"0.478902726","_rn_":"77"},{"1":"-0.374730531","_rn_":"78"},{"1":"-0.476009054","_rn_":"79"},{"1":"0.204003880","_rn_":"80"},{"1":"0.044851917","_rn_":"81"},{"1":"0.305282402","_rn_":"82"},{"1":"0.247408961","_rn_":"83"},{"1":"-0.533882495","_rn_":"84"},{"1":"0.117193718","_rn_":"85"},{"1":"-0.186641848","_rn_":"86"},{"1":"0.001446836","_rn_":"87"},{"1":"-0.056426605","_rn_":"88"},{"1":"0.146130439","_rn_":"89"},{"1":"-0.056426605","_rn_":"90"},{"1":"-0.316857090","_rn_":"91"},{"1":"0.652523049","_rn_":"92"},{"1":"0.363155843","_rn_":"93"},{"1":"-0.056426605","_rn_":"94"},{"1":"-0.128768407","_rn_":"95"},{"1":"0.146130439","_rn_":"96"},{"1":"-0.056426605","_rn_":"97"},{"1":"0.189535520","_rn_":"98"},{"1":"-0.172173487","_rn_":"99"},{"1":"-0.447072333","_rn_":"100"},{"1":"0.334219123","_rn_":"101"},{"1":"-0.041958245","_rn_":"102"},{"1":"-0.143236767","_rn_":"103"},{"1":"0.088256998","_rn_":"104"},{"1":"0.768269931","_rn_":"105"},{"1":"-0.360262171","_rn_":"106"},{"1":"-0.345793811","_rn_":"107"},{"1":"-0.389198892","_rn_":"108"},{"1":"-0.070894965","_rn_":"109"},{"1":"-0.504945774","_rn_":"110"},{"1":"-0.432603973","_rn_":"111"},{"1":"0.218472240","_rn_":"112"},{"1":"-0.172173487","_rn_":"113"},{"1":"-0.041958245","_rn_":"114"},{"1":"-0.085363326","_rn_":"115"},{"1":"-0.128768407","_rn_":"116"},{"1":"-0.013021524","_rn_":"117"},{"1":"0.131662079","_rn_":"118"},{"1":"-0.215578568","_rn_":"119"},{"1":"0.117193718","_rn_":"120"},{"1":"0.088256998","_rn_":"121"},{"1":"0.247408961","_rn_":"122"},{"1":"-0.374730531","_rn_":"123"},{"1":"0.088256998","_rn_":"124"},{"1":"-0.201110208","_rn_":"125"},{"1":"-0.114300046","_rn_":"126"},{"1":"-0.345793811","_rn_":"127"},{"1":"-0.070894965","_rn_":"128"},{"1":"-0.070894965","_rn_":"129"},{"1":"0.131662079","_rn_":"130"},{"1":"0.305282402","_rn_":"131"},{"1":"0.160598799","_rn_":"132"},{"1":"-0.389198892","_rn_":"133"},{"1":"0.015915196","_rn_":"134"},{"1":"0.088256998","_rn_":"135"},{"1":"-0.172173487","_rn_":"136"},{"1":"-0.099831686","_rn_":"137"},{"1":"-0.070894965","_rn_":"138"},{"1":"0.204003880","_rn_":"139"},{"1":"-0.128768407","_rn_":"140"},{"1":"0.189535520","_rn_":"141"},{"1":"0.088256998","_rn_":"142"},{"1":"-0.041958245","_rn_":"143"},{"1":"0.088256998","_rn_":"144"},{"1":"-0.070894965","_rn_":"145"},{"1":"-0.287920370","_rn_":"146"},{"1":"0.392092564","_rn_":"147"},{"1":"-0.143236767","_rn_":"148"},{"1":"-0.056426605","_rn_":"149"},{"1":"-0.230046929","_rn_":"150"},{"1":"-0.186641848","_rn_":"151"},{"1":"-0.114300046","_rn_":"152"},{"1":"-0.027489885","_rn_":"153"},{"1":"0.218472240","_rn_":"154"},{"1":"-0.085363326","_rn_":"155"},{"1":"-0.085363326","_rn_":"156"},{"1":"0.334219123","_rn_":"157"},{"1":"-0.027489885","_rn_":"158"},{"1":"0.449966005","_rn_":"159"},{"1":"0.363155843","_rn_":"160"},{"1":"-0.099831686","_rn_":"161"},{"1":"-0.432603973","_rn_":"162"},{"1":"-0.041958245","_rn_":"163"},{"1":"-0.114300046","_rn_":"164"},{"1":"-0.013021524","_rn_":"165"},{"1":"0.189535520","_rn_":"166"},{"1":"0.204003880","_rn_":"167"},{"1":"0.261877321","_rn_":"168"},{"1":"0.261877321","_rn_":"169"},{"1":"0.392092564","_rn_":"170"},{"1":"-0.287920370","_rn_":"171"},{"1":"-0.041958245","_rn_":"172"},{"1":"0.261877321","_rn_":"173"},{"1":"0.117193718","_rn_":"174"},{"1":"0.088256998","_rn_":"175"},{"1":"-0.085363326","_rn_":"176"},{"1":"0.189535520","_rn_":"177"},{"1":"0.015915196","_rn_":"178"},{"1":"0.044851917","_rn_":"179"},{"1":"-0.230046929","_rn_":"180"},{"1":"-0.345793811","_rn_":"181"},{"1":"0.218472240","_rn_":"182"},{"1":"-0.258983649","_rn_":"183"},{"1":"0.015915196","_rn_":"184"},{"1":"0.088256998","_rn_":"185"},{"1":"-0.056426605","_rn_":"186"},{"1":"-0.360262171","_rn_":"187"},{"1":"0.146130439","_rn_":"188"},{"1":"0.204003880","_rn_":"189"},{"1":"-0.374730531","_rn_":"190"},{"1":"-0.027489885","_rn_":"191"},{"1":"-0.041958245","_rn_":"192"},{"1":"0.044851917","_rn_":"193"},{"1":"0.001446836","_rn_":"194"},{"1":"-0.403667252","_rn_":"195"},{"1":"-0.027489885","_rn_":"196"},{"1":"0.189535520","_rn_":"197"},{"1":"0.160598799","_rn_":"198"},{"1":"-0.186641848","_rn_":"199"},{"1":"0.348687483","_rn_":"200"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="addiert-zu-den-fixed-effects" class="section level4">
<h4><span class="header-section-number">4.2.1.2</span> … addiert zu den fixed effects</h4>
<p>Hier werden die individuellen Effekte zu den <span style=" font-weight: bold;    color: #6BBFA6 !important;">fixed effects</span> dazugerechnet; damit erhalten wir <span style=" font-weight: bold;    color: #E8793A !important;">random coefficients</span>. Für <code>occasion</code> ändert sich nichts, weil wir nicht erlaubt haben, dass der slope pro Student variiert.</p>
<pre class="sourceCode r"><code class="sourceCode r">(random_coefficients &lt;-<span class="st"> </span><span class="kw">coef</span>(gpa_mixed)<span class="op">$</span>student)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["(Intercept)"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["occasion"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"2.528319","2":"0.1063143","_rn_":"1"},{"1":"2.383636","2":"0.1063143","_rn_":"2"},{"1":"2.687471","2":"0.1063143","_rn_":"3"},{"1":"2.412572","2":"0.1063143","_rn_":"4"},{"1":"2.629598","2":"0.1063143","_rn_":"5"},{"1":"2.296826","2":"0.1063143","_rn_":"6"},{"1":"2.455978","2":"0.1063143","_rn_":"7"},{"1":"2.817687","2":"0.1063143","_rn_":"8"},{"1":"2.701940","2":"0.1063143","_rn_":"9"},{"1":"2.615129","2":"0.1063143","_rn_":"10"},{"1":"2.962370","2":"0.1063143","_rn_":"11"},{"1":"2.600661","2":"0.1063143","_rn_":"12"},{"1":"3.121522","2":"0.1063143","_rn_":"13"},{"1":"2.716408","2":"0.1063143","_rn_":"14"},{"1":"2.383636","2":"0.1063143","_rn_":"15"},{"1":"2.470446","2":"0.1063143","_rn_":"16"},{"1":"2.325762","2":"0.1063143","_rn_":"17"},{"1":"2.296826","2":"0.1063143","_rn_":"18"},{"1":"2.499383","2":"0.1063143","_rn_":"19"},{"1":"2.832155","2":"0.1063143","_rn_":"20"},{"1":"2.296826","2":"0.1063143","_rn_":"21"},{"1":"2.716408","2":"0.1063143","_rn_":"22"},{"1":"2.673003","2":"0.1063143","_rn_":"23"},{"1":"2.600661","2":"0.1063143","_rn_":"24"},{"1":"2.991307","2":"0.1063143","_rn_":"25"},{"1":"2.325762","2":"0.1063143","_rn_":"26"},{"1":"2.224484","2":"0.1063143","_rn_":"27"},{"1":"2.716408","2":"0.1063143","_rn_":"28"},{"1":"2.701940","2":"0.1063143","_rn_":"29"},{"1":"2.817687","2":"0.1063143","_rn_":"30"},{"1":"2.238952","2":"0.1063143","_rn_":"31"},{"1":"2.861092","2":"0.1063143","_rn_":"32"},{"1":"2.470446","2":"0.1063143","_rn_":"33"},{"1":"2.383636","2":"0.1063143","_rn_":"34"},{"1":"2.687471","2":"0.1063143","_rn_":"35"},{"1":"2.730876","2":"0.1063143","_rn_":"36"},{"1":"2.687471","2":"0.1063143","_rn_":"37"},{"1":"3.020244","2":"0.1063143","_rn_":"38"},{"1":"2.542788","2":"0.1063143","_rn_":"39"},{"1":"2.875560","2":"0.1063143","_rn_":"40"},{"1":"3.121522","2":"0.1063143","_rn_":"41"},{"1":"2.542788","2":"0.1063143","_rn_":"42"},{"1":"2.673003","2":"0.1063143","_rn_":"43"},{"1":"2.774281","2":"0.1063143","_rn_":"44"},{"1":"2.774281","2":"0.1063143","_rn_":"45"},{"1":"2.311294","2":"0.1063143","_rn_":"46"},{"1":"2.369167","2":"0.1063143","_rn_":"47"},{"1":"2.600661","2":"0.1063143","_rn_":"48"},{"1":"2.701940","2":"0.1063143","_rn_":"49"},{"1":"2.528319","2":"0.1063143","_rn_":"50"},{"1":"2.571724","2":"0.1063143","_rn_":"51"},{"1":"2.759813","2":"0.1063143","_rn_":"52"},{"1":"2.673003","2":"0.1063143","_rn_":"53"},{"1":"2.788750","2":"0.1063143","_rn_":"54"},{"1":"2.745345","2":"0.1063143","_rn_":"55"},{"1":"2.340231","2":"0.1063143","_rn_":"56"},{"1":"2.673003","2":"0.1063143","_rn_":"57"},{"1":"2.412572","2":"0.1063143","_rn_":"58"},{"1":"2.658535","2":"0.1063143","_rn_":"59"},{"1":"2.441509","2":"0.1063143","_rn_":"60"},{"1":"2.861092","2":"0.1063143","_rn_":"61"},{"1":"2.484914","2":"0.1063143","_rn_":"62"},{"1":"2.875560","2":"0.1063143","_rn_":"63"},{"1":"2.701940","2":"0.1063143","_rn_":"64"},{"1":"2.354699","2":"0.1063143","_rn_":"65"},{"1":"2.803218","2":"0.1063143","_rn_":"66"},{"1":"2.383636","2":"0.1063143","_rn_":"67"},{"1":"2.325762","2":"0.1063143","_rn_":"68"},{"1":"2.325762","2":"0.1063143","_rn_":"69"},{"1":"2.615129","2":"0.1063143","_rn_":"70"},{"1":"2.600661","2":"0.1063143","_rn_":"71"},{"1":"3.034712","2":"0.1063143","_rn_":"72"},{"1":"2.383636","2":"0.1063143","_rn_":"73"},{"1":"2.817687","2":"0.1063143","_rn_":"74"},{"1":"2.629598","2":"0.1063143","_rn_":"75"},{"1":"2.759813","2":"0.1063143","_rn_":"76"},{"1":"3.078117","2":"0.1063143","_rn_":"77"},{"1":"2.224484","2":"0.1063143","_rn_":"78"},{"1":"2.123205","2":"0.1063143","_rn_":"79"},{"1":"2.803218","2":"0.1063143","_rn_":"80"},{"1":"2.644066","2":"0.1063143","_rn_":"81"},{"1":"2.904497","2":"0.1063143","_rn_":"82"},{"1":"2.846623","2":"0.1063143","_rn_":"83"},{"1":"2.065332","2":"0.1063143","_rn_":"84"},{"1":"2.716408","2":"0.1063143","_rn_":"85"},{"1":"2.412572","2":"0.1063143","_rn_":"86"},{"1":"2.600661","2":"0.1063143","_rn_":"87"},{"1":"2.542788","2":"0.1063143","_rn_":"88"},{"1":"2.745345","2":"0.1063143","_rn_":"89"},{"1":"2.542788","2":"0.1063143","_rn_":"90"},{"1":"2.282357","2":"0.1063143","_rn_":"91"},{"1":"3.251737","2":"0.1063143","_rn_":"92"},{"1":"2.962370","2":"0.1063143","_rn_":"93"},{"1":"2.542788","2":"0.1063143","_rn_":"94"},{"1":"2.470446","2":"0.1063143","_rn_":"95"},{"1":"2.745345","2":"0.1063143","_rn_":"96"},{"1":"2.542788","2":"0.1063143","_rn_":"97"},{"1":"2.788750","2":"0.1063143","_rn_":"98"},{"1":"2.427041","2":"0.1063143","_rn_":"99"},{"1":"2.152142","2":"0.1063143","_rn_":"100"},{"1":"2.933433","2":"0.1063143","_rn_":"101"},{"1":"2.557256","2":"0.1063143","_rn_":"102"},{"1":"2.455978","2":"0.1063143","_rn_":"103"},{"1":"2.687471","2":"0.1063143","_rn_":"104"},{"1":"3.367484","2":"0.1063143","_rn_":"105"},{"1":"2.238952","2":"0.1063143","_rn_":"106"},{"1":"2.253420","2":"0.1063143","_rn_":"107"},{"1":"2.210015","2":"0.1063143","_rn_":"108"},{"1":"2.528319","2":"0.1063143","_rn_":"109"},{"1":"2.094269","2":"0.1063143","_rn_":"110"},{"1":"2.166610","2":"0.1063143","_rn_":"111"},{"1":"2.817687","2":"0.1063143","_rn_":"112"},{"1":"2.427041","2":"0.1063143","_rn_":"113"},{"1":"2.557256","2":"0.1063143","_rn_":"114"},{"1":"2.513851","2":"0.1063143","_rn_":"115"},{"1":"2.470446","2":"0.1063143","_rn_":"116"},{"1":"2.586193","2":"0.1063143","_rn_":"117"},{"1":"2.730876","2":"0.1063143","_rn_":"118"},{"1":"2.383636","2":"0.1063143","_rn_":"119"},{"1":"2.716408","2":"0.1063143","_rn_":"120"},{"1":"2.687471","2":"0.1063143","_rn_":"121"},{"1":"2.846623","2":"0.1063143","_rn_":"122"},{"1":"2.224484","2":"0.1063143","_rn_":"123"},{"1":"2.687471","2":"0.1063143","_rn_":"124"},{"1":"2.398104","2":"0.1063143","_rn_":"125"},{"1":"2.484914","2":"0.1063143","_rn_":"126"},{"1":"2.253420","2":"0.1063143","_rn_":"127"},{"1":"2.528319","2":"0.1063143","_rn_":"128"},{"1":"2.528319","2":"0.1063143","_rn_":"129"},{"1":"2.730876","2":"0.1063143","_rn_":"130"},{"1":"2.904497","2":"0.1063143","_rn_":"131"},{"1":"2.759813","2":"0.1063143","_rn_":"132"},{"1":"2.210015","2":"0.1063143","_rn_":"133"},{"1":"2.615129","2":"0.1063143","_rn_":"134"},{"1":"2.687471","2":"0.1063143","_rn_":"135"},{"1":"2.427041","2":"0.1063143","_rn_":"136"},{"1":"2.499383","2":"0.1063143","_rn_":"137"},{"1":"2.528319","2":"0.1063143","_rn_":"138"},{"1":"2.803218","2":"0.1063143","_rn_":"139"},{"1":"2.470446","2":"0.1063143","_rn_":"140"},{"1":"2.788750","2":"0.1063143","_rn_":"141"},{"1":"2.687471","2":"0.1063143","_rn_":"142"},{"1":"2.557256","2":"0.1063143","_rn_":"143"},{"1":"2.687471","2":"0.1063143","_rn_":"144"},{"1":"2.528319","2":"0.1063143","_rn_":"145"},{"1":"2.311294","2":"0.1063143","_rn_":"146"},{"1":"2.991307","2":"0.1063143","_rn_":"147"},{"1":"2.455978","2":"0.1063143","_rn_":"148"},{"1":"2.542788","2":"0.1063143","_rn_":"149"},{"1":"2.369167","2":"0.1063143","_rn_":"150"},{"1":"2.412572","2":"0.1063143","_rn_":"151"},{"1":"2.484914","2":"0.1063143","_rn_":"152"},{"1":"2.571724","2":"0.1063143","_rn_":"153"},{"1":"2.817687","2":"0.1063143","_rn_":"154"},{"1":"2.513851","2":"0.1063143","_rn_":"155"},{"1":"2.513851","2":"0.1063143","_rn_":"156"},{"1":"2.933433","2":"0.1063143","_rn_":"157"},{"1":"2.571724","2":"0.1063143","_rn_":"158"},{"1":"3.049180","2":"0.1063143","_rn_":"159"},{"1":"2.962370","2":"0.1063143","_rn_":"160"},{"1":"2.499383","2":"0.1063143","_rn_":"161"},{"1":"2.166610","2":"0.1063143","_rn_":"162"},{"1":"2.557256","2":"0.1063143","_rn_":"163"},{"1":"2.484914","2":"0.1063143","_rn_":"164"},{"1":"2.586193","2":"0.1063143","_rn_":"165"},{"1":"2.788750","2":"0.1063143","_rn_":"166"},{"1":"2.803218","2":"0.1063143","_rn_":"167"},{"1":"2.861092","2":"0.1063143","_rn_":"168"},{"1":"2.861092","2":"0.1063143","_rn_":"169"},{"1":"2.991307","2":"0.1063143","_rn_":"170"},{"1":"2.311294","2":"0.1063143","_rn_":"171"},{"1":"2.557256","2":"0.1063143","_rn_":"172"},{"1":"2.861092","2":"0.1063143","_rn_":"173"},{"1":"2.716408","2":"0.1063143","_rn_":"174"},{"1":"2.687471","2":"0.1063143","_rn_":"175"},{"1":"2.513851","2":"0.1063143","_rn_":"176"},{"1":"2.788750","2":"0.1063143","_rn_":"177"},{"1":"2.615129","2":"0.1063143","_rn_":"178"},{"1":"2.644066","2":"0.1063143","_rn_":"179"},{"1":"2.369167","2":"0.1063143","_rn_":"180"},{"1":"2.253420","2":"0.1063143","_rn_":"181"},{"1":"2.817687","2":"0.1063143","_rn_":"182"},{"1":"2.340231","2":"0.1063143","_rn_":"183"},{"1":"2.615129","2":"0.1063143","_rn_":"184"},{"1":"2.687471","2":"0.1063143","_rn_":"185"},{"1":"2.542788","2":"0.1063143","_rn_":"186"},{"1":"2.238952","2":"0.1063143","_rn_":"187"},{"1":"2.745345","2":"0.1063143","_rn_":"188"},{"1":"2.803218","2":"0.1063143","_rn_":"189"},{"1":"2.224484","2":"0.1063143","_rn_":"190"},{"1":"2.571724","2":"0.1063143","_rn_":"191"},{"1":"2.557256","2":"0.1063143","_rn_":"192"},{"1":"2.644066","2":"0.1063143","_rn_":"193"},{"1":"2.600661","2":"0.1063143","_rn_":"194"},{"1":"2.195547","2":"0.1063143","_rn_":"195"},{"1":"2.571724","2":"0.1063143","_rn_":"196"},{"1":"2.788750","2":"0.1063143","_rn_":"197"},{"1":"2.759813","2":"0.1063143","_rn_":"198"},{"1":"2.412572","2":"0.1063143","_rn_":"199"},{"1":"2.947902","2":"0.1063143","_rn_":"200"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Konfidenzintervalle für die Standardfehler kann man auch kriegen. <span style=" font-weight: bold;    color: #E8793A !important;">.sigma</span> bezieht sich auf die Schätzung für - klar - <span style=" font-weight: bold;    color: #E8793A !important;">sigma</span> (= <span style=" font-weight: bold;    color: #6BBFA6 !important;">residual standard error</span>) und <span style=" font-weight: bold;    color: #E8793A !important;">.sig01</span> bezieht sich auf die Varianz durch die Studenten.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">confint</span>(gpa_mixed)</code></pre>
<pre><code>##                  2.5 %    97.5 %
## .sig01      0.22517423 0.2824604
## .sigma      0.23071113 0.2518510
## (Intercept) 2.55665145 2.6417771
## occasion    0.09832589 0.1143027</code></pre>
</div>
</div>
<div id="predictions-plotten" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Predictions plotten</h3>
<p>Sehr nice: Mal der Vergleich für die ersten drei Studenten für</p>
<ul>
<li><ol style="list-style-type: lower-alpha">
<li>das linear model</li>
</ol></li>
<li><ol start="2" style="list-style-type: lower-alpha">
<li>das mixed model mit den random effects “disabled”</li>
</ol>
<ul>
<li>… was hier dasselbe ist wie das lineare model.</li>
</ul></li>
<li><ol start="3" style="list-style-type: lower-alpha">
<li>das mixed model inklusive random effects</li>
</ol></li>
</ul>
<p><span style=" font-weight: bold;    color: #E8793A !important;">TO DO:</span> Wenn random slopes dazu kommen, coolen Plot mit Estimate für jeden einzelnen Studenten darstellen. Auch als coole animierte Version, siehe Introduction.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># a)</span>
predict_mixed_no_re &lt;-<span class="st">  </span><span class="kw">predict</span>(gpa_mixed, <span class="dt">re.form =</span> <span class="ot">NA</span>)
<span class="co"># b)</span>
predict_mixed &lt;-<span class="st">  </span><span class="kw">predict</span>(gpa_mixed)
<span class="co"># c)</span>
predict_lm &lt;-<span class="st">  </span><span class="kw">predict</span>(gpa_lm)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">df_predictions &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">student =</span> gpa<span class="op">$</span>student, <span class="dt">occasion =</span> gpa<span class="op">$</span>occasion,
                             <span class="dt">gpa =</span> gpa<span class="op">$</span>gpa, <span class="dt">mixed_no_re =</span> predict_mixed_no_re,
                             <span class="dt">mixed =</span> predict_mixed, <span class="dt">lm =</span> predict_lm) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(student <span class="op">%in%</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)

df_for_plot &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
  <span class="dt">source =</span> <span class="kw">c</span>(<span class="kw">case_when</span>(df_predictions<span class="op">$</span>student <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> &quot;mixed student 1&quot;</span>,
                       df_predictions<span class="op">$</span>student <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> &quot;mixed student 2&quot;</span>,
                       df_predictions<span class="op">$</span>student <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> &quot;mixed student 3&quot;</span>),
             <span class="kw">rep</span>(<span class="st">&quot;linear model&quot;</span>, <span class="dv">6</span>)),
  <span class="dt">occasion =</span> <span class="kw">c</span>(df_predictions<span class="op">$</span>occasion, <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>),
  <span class="dt">gpa =</span> <span class="kw">c</span>(df_predictions<span class="op">$</span>gpa, <span class="kw">rep</span>(<span class="ot">NA</span>, <span class="dv">6</span>)),
  <span class="dt">prediction =</span> <span class="kw">c</span>(df_predictions<span class="op">$</span>mixed, 
                 df_predictions<span class="op">$</span>lm[df_predictions<span class="op">$</span>student <span class="op">==</span><span class="st"> </span><span class="dv">1</span>])
)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">df_for_plot <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> occasion)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> gpa, <span class="dt">colour =</span> source)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">y =</span> prediction, <span class="dt">colour =</span> source), <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,
              <span class="dt">fullrange =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_manual</span>(<span class="st">&quot;prediction&quot;</span>, <span class="dt">values =</span> <span class="kw">c</span>(<span class="kw">pick_colour</span>(<span class="dv">5</span>, <span class="st">&quot;farbschema&quot;</span>)),
                      <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="dv">2</span>)) <span class="op">+</span>
<span class="st">  </span>julis_theme</code></pre>
<p><img src="01_1_first_things_first_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p><span class="math inline">\(\to\)</span> Siehe Skript uebungen.R – Übung #2 für dasselbe nochmal, nur diesmal mit Schlaf-Beispieldaten.</p>
<p><span class="math inline">\(\to\)</span> Siehe Skript uebungen.R – Übung #3 Cluster Level Covariance (d.h. mehr fixed effects … ?) für die GPA-Daten</p>
</div>
</div>
<div id="simulationen" class="section level2">
<h2><span class="header-section-number">4.3</span> Simulationen</h2>
<p>Zum besseren Verständnis: Rumspielen mit verschiedenen Parametern von simulierten Daten und das entsprechende Resultat im mixed model. In den Notes anstatt in den Übungen, weil echt hilfreich. <span style=" font-weight: bold;    color: #6BBFA6 !important;">Übersicht aller Modelle und Density Plots nebeneinander in der Tabelle unten.</span></p>
<p>“In what follows we’ll change various aspects of the data, then rerun the model after each change […]. For each note specifically at least one thing that changed in the results.”</p>
<p><span style=" font-weight: bold;    color: #ad4f19 !important;">0. First calculate or simply eyeball the intraclass correlation coefficient:</span></p>
<p><span class="math display">\[\frac{\textrm{random effect variance}}{\textrm{residual + random effect variance}}\]</span>
<span style=" font-weight: bold;    color: #ad4f19 !important;">In addition, create a density plot of the random effects.</span></p>
<div id="run-1---default" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Run 1 - default</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># vorgegebener Code siehe mixed_models_basics.Rmd</span>
<span class="co"># Aber das geht so nicht - das muss erst mal in eine Funktion</span>
rand_int_sim &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">Ngroups =</span> <span class="dv">100</span>, <span class="dt">NperGroup =</span> <span class="dv">3</span>, <span class="dt">sdRandIntercept =</span> <span class="fl">.5</span>, 
                         <span class="dt">sdError =</span> <span class="fl">.25</span>, <span class="dt">sdFixedEffect =</span> <span class="fl">.5</span>, <span class="dt">AvIntercept =</span> <span class="dv">2</span>){
  N &lt;-<span class="st"> </span>Ngroups <span class="op">*</span><span class="st"> </span>NperGroup
  groups &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>Ngroups, <span class="dt">each =</span> NperGroup))
  u &lt;-<span class="st"> </span><span class="kw">rnorm</span>(Ngroups, <span class="dt">sd =</span> sdRandIntercept)
  e &lt;-<span class="st"> </span><span class="kw">rnorm</span>(N, <span class="dt">sd =</span> sdError)
  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(N)
  y &lt;-<span class="st"> </span>AvIntercept <span class="op">+</span><span class="st"> </span>sdFixedEffect <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>u[groups] <span class="op">+</span><span class="st"> </span>e
  
  <span class="kw">return</span>(<span class="kw">data.frame</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">groups =</span> groups))
}</code></pre>
<p><span style=" font-weight: bold;    color: #ad4f19 !important;">Which of the above represent the fixed and random effects?</span></p>
<p>x = fixed effect; u[groups] = random effect</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">2806</span>)
run1 &lt;-<span class="st"> </span><span class="kw">rand_int_sim</span>()

model1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>groups), <span class="dt">data =</span> run1)

<span class="kw">tidy</span>(model1) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate_at</span>(<span class="dt">.vars =</span> <span class="kw">c</span>(<span class="st">&quot;estimate&quot;</span>, <span class="st">&quot;std.error&quot;</span>, <span class="st">&quot;statistic&quot;</span>), 
            <span class="dt">.funs =</span> force_decimals) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">kable_styling</span>(<span class="st">&quot;striped&quot;</span>)</code></pre>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
effect
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
term
</th>
<th style="text-align:left;">
estimate
</th>
<th style="text-align:left;">
std.error
</th>
<th style="text-align:left;">
statistic
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:left;">
1.95
</td>
<td style="text-align:left;">
0.05
</td>
<td style="text-align:left;">
37.89
</td>
</tr>
<tr>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
x
</td>
<td style="text-align:left;">
0.50
</td>
<td style="text-align:left;">
0.02
</td>
<td style="text-align:left;">
32.65
</td>
</tr>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
groups
</td>
<td style="text-align:left;">
sd__(Intercept)
</td>
<td style="text-align:left;">
0.50
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
Residual
</td>
<td style="text-align:left;">
sd__Observation
</td>
<td style="text-align:left;">
0.23
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
</tbody>
</table>
<p>Einmal die Tabelle hier zur Veranschaulichung, alles Weitere in der Vergleichstabelle für alle Läufe unten. Intraclass Correlations und Density Plots ebenfalls unten.</p>
<p>Hier sehen wir aber zunächst, dass sich die von uns spezifizierten Parameter genau im Modell ablesen lassen: Die Residual Standard Deviation liegt bei .23 - wir haben dem error term e in der Simulation ja .25 zugewiesen. x wird (fast) genau wie spezifiziert auf .5 geschätzt. Und das Intercept passt auch: 1.95 (übergeben: 2). Das Intercept der groups hat eine Standard Deviation von .50 - passt auch beinahe genau. Bin noch nicht vollkommen sicher, wie ich die aufgeklärte Varianz beurteilen soll.</p>
<pre class="sourceCode r"><code class="sourceCode r">tb_intracl &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">formatVC</span>(<span class="kw">VarCorr</span>(model1), <span class="dt">comp =</span> <span class="kw">c</span>(<span class="st">&quot;Var&quot;</span>, <span class="st">&quot;Std&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Variance =</span> <span class="kw">as.numeric</span>(<span class="kw">as.character</span>(Variance)))

intracl1 &lt;-<span class="st"> </span>(tb_intracl<span class="op">$</span>Variance[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(tb_intracl<span class="op">$</span>Variance)) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></code></pre>
<p>Intraclass correlation: Groups klären <span class="math inline">\(81.99\)</span> <span class="math inline">\(\%\)</span> der Gesamtvarianz auf.</p>
</div>
<div id="run-2---different-random-effect-variance" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Run 2 - Different random effect variance</h3>
<p><span style=" font-weight: bold;    color: #ad4f19 !important;">1. Change the random effect variance/sd and/or the residual variance/sd and note your new estimate of the ICC, and plot the random effect as before.</span></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">2806</span>)
run2 &lt;-<span class="st"> </span><span class="kw">rand_int_sim</span>(<span class="dt">sdRandIntercept =</span> <span class="dv">1</span>)

model2 &lt;-<span class="st"> </span><span class="kw">lmer</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>groups), <span class="dt">data =</span> run2)</code></pre>
<p>Siehe Zusammenfassung unten: Im Prinzip sind alle Werte dieselben bis auf die Standard Deviation für das Intercept der Groups. Der ist jetzt bei 1 (vorher .50), und das ist ja auch das Einzige, was ich geändert habe. Interessanterweise gibt es leichte Abweichungen in den anderen Werten. Das sollte nicht daran liegen, dass ich eingangs zwar denselben Seed gesetzt habe, aber den Prozess des Samplings dann durch Änderungen in den Parametern vor dem Sampling des Intercepts verändert habe. Das sollte dann passieren, wenn ich das N ändere und somit der Startpunkt (vom Seed aus) für das Sampling des Intercepts ein anderer ist. Aber wenn ich hier keinen Denkfehler mache, wurde das Intercept leicht durch die Varianz des random effects (auf das Intercept) beeinflusst … ?</p>
<p>Intraclass correlation: Groups klären <span class="math inline">\(94.94\)</span> <span class="math inline">\(\%\)</span> der Gesamtvarianz auf. Was mega krass ist. Ergibt natürlich Sinn, weil ich die Varianz der Gruppen brutal hochgeschraubt habe. Ich verstehe nur noch nicht ganz, wieso die fixed effects hier nicht einbezogen werden, sondern nur der Effekt von group durch group <span class="math inline">\(+\)</span> residual gerechnet wird? Hat vermutlich damit zu tun, dass der Effekt von <span class="math inline">\(x\)</span> ja mit oder ohne random intercept derselbe bleibt.</p>
</div>
<div id="run-3---different-residual-variance" class="section level3">
<h3><span class="header-section-number">4.3.3</span> Run 3 - Different residual variance</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">2806</span>)
run3 &lt;-<span class="st"> </span><span class="kw">rand_int_sim</span>(<span class="dt">sdError =</span> <span class="fl">.5</span>)

model3 &lt;-<span class="st"> </span><span class="kw">lmer</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>groups), <span class="dt">data =</span> run3)</code></pre>
<p>Siehe Zusammenfassung unten. Vergleich zum Default Model 1: Geändert hat sich nur die Residual Standard Deviation: Von .23 auf .47.</p>
<p>Intraclass correlation: Groups klären <span class="math inline">\(51.75\)</span> <span class="math inline">\(\%\)</span> der Gesamtvarianz auf. Also viel weniger als in Lauf 1 oder 2, weil das Residual natürlich umso mehr Varianz aufklärt.</p>
</div>
<div id="run-4---different-random-effect-and-residual-variance" class="section level3">
<h3><span class="header-section-number">4.3.4</span> Run 4 - Different random effect and residual variance</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">2806</span>)
run4 &lt;-<span class="st"> </span><span class="kw">rand_int_sim</span>(<span class="dt">sdRandIntercept =</span> <span class="dv">1</span>, <span class="dt">sdError =</span> <span class="fl">.5</span>)

model4 &lt;-<span class="st"> </span><span class="kw">lmer</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>groups), <span class="dt">data =</span> run4)</code></pre>
<p>Siehe Übersicht unten: Das sind jetzt die beiden Veränderungen aus Run 2 und 3 zusammengeführt.</p>
<p>Intraclass correlation: Groups klären <span class="math inline">\(81.99\)</span> <span class="math inline">\(\%\)</span> der Gesamtvarianz auf. Interessanterweise etwa so viel wie das default Modell 1.</p>
</div>
<div id="ubersicht" class="section level3">
<h3><span class="header-section-number">4.3.5</span> Übersicht</h3>
<ul>
<li>Run 1: default</li>
<li>Run 2: different random effect variance</li>
<li>Run 3: different residual variance</li>
<li>Run 4: different random effect and residual variance</li>
</ul>
<table class="table table-striped" style="font-size: 14px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-36">Table 4.6: </span>Simulationsübersicht
</caption>
<thead>
<tr>
<th style="border-bottom:hidden" colspan="3">
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="4">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Standardabweichung
</div>
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="4">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Standard Error
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
effect
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
term
</th>
<th style="text-align:left;">
run1
</th>
<th style="text-align:left;">
run2
</th>
<th style="text-align:left;">
run3
</th>
<th style="text-align:left;">
run4
</th>
<th style="text-align:left;">
run1
</th>
<th style="text-align:left;">
run2
</th>
<th style="text-align:left;">
run3
</th>
<th style="text-align:left;">
run4
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
1.95
</td>
<td style="text-align:left;">
1.90
</td>
<td style="text-align:left;">
1.94
</td>
<td style="text-align:left;">
1.89
</td>
<td style="text-align:left;">
0.05
</td>
<td style="text-align:left;">
0.10
</td>
<td style="text-align:left;">
0.06
</td>
<td style="text-align:left;">
0.10
</td>
</tr>
<tr>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
x
</td>
<td style="text-align:left;">
0.50
</td>
<td style="text-align:left;">
0.51
</td>
<td style="text-align:left;">
0.50
</td>
<td style="text-align:left;">
0.51
</td>
<td style="text-align:left;">
0.02
</td>
<td style="text-align:left;">
0.02
</td>
<td style="text-align:left;">
0.03
</td>
<td style="text-align:left;">
0.03
</td>
</tr>
<tr>
<td style="text-align:left;">
random
</td>
<td style="text-align:left;">
groups
</td>
<td style="text-align:left;">
SD Intercept
</td>
<td style="text-align:left;">
0.50
</td>
<td style="text-align:left;">
1.01
</td>
<td style="text-align:left;">
0.48
</td>
<td style="text-align:left;">
0.99
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
random
</td>
<td style="text-align:left;">
residual
</td>
<td style="text-align:left;">
SD Observation
</td>
<td style="text-align:left;">
0.23
</td>
<td style="text-align:left;">
0.23
</td>
<td style="text-align:left;">
0.47
</td>
<td style="text-align:left;">
0.46
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
</tbody>
</table>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-37">Table 4.7: </span>Intraclass Correlations
</caption>
<thead>
<tr>
<th style="text-align:left;">
run1
</th>
<th style="text-align:left;">
run2
</th>
<th style="text-align:left;">
run3
</th>
<th style="text-align:left;">
run4
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
81.99
</td>
<td style="text-align:left;">
94.94
</td>
<td style="text-align:left;">
51.75
</td>
<td style="text-align:left;">
81.99
</td>
</tr>
</tbody>
</table>
<div id="density-plots" class="section level4">
<h4><span class="header-section-number">4.3.5.1</span> Density Plots</h4>
<p>Orange ist der Mittelwert, der 0 ist. Spannend aber, wie asymmetrisch die sind. Run 2: Höhere Varianz des Random Effects bedeutet mehr Unsicherheit, wo er liegt? Run 3: Weil das Residual größer ist, schätzen wir den Effekt der Gruppe aufs Intercept eher auf 0? Rund 4: Sieht eher aus wie der aus Run 2. Die größere Varianz des Random Effects hat mehr Einfluss als die größere Residual Standard Deviation?</p>
<p><img src="01_1_first_things_first_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
</div>
<div id="lineare-regressionen" class="section level4">
<h4><span class="header-section-number">4.3.5.2</span> Lineare Regressionen</h4>
<p>Problem beim Plotten: Die Daten bestehen aus 100 3er-Grüppchen. Es ist nicht so übersichtlich, den Plot danach zu gruppieren. Daher hier mal vier rausgegriffen und der Rest zusammengefasst. Jede Gruppe hat eine lineare Regressionslinie bekommen. (Blau/orange vier herausgepickte Gruppen, grün-beige die restlichen Gruppen zusammengefasst.) Interessanterweise sieht es hier so aus, als wären auch ein Random Slopes pro Gruppe angemessen.</p>
<p><img src="01_1_first_things_first_files/figure-html/unnamed-chunk-39-1.png" width="110%" /></p>
</div>
<div id="mixed-models-1" class="section level4">
<h4><span class="header-section-number">4.3.5.3</span> Mixed Models</h4>
<p><img src="01_1_first_things_first_files/figure-html/unnamed-chunk-40-1.png" width="110%" /></p>
<p>D.h. wenn man jede Gruppe für sich linear schätzt (was <code>geom_smooth</code> mit <code>method = "lm"</code> hier ja tut), ergibt sich ein anderes Bild als durch das mixed model. Wir wissen ja durch die Simulation, dass es keine random slopes pro Gruppe gibt (vermutlich würde auch das lineare Modell ähnliche Schätzungen liefern, wenn es nicht nur drei Datenpunkte pro Gruppe wären). Schon krass irgendwo, dass ein mixed Model viel mehr ist (sein kann?) als einfach nur ein lineares Modell pro Gruppe. Man beachte, dass die zusammengefasste Schätzung für die restlichen Gruppen einen anderen Slope hat, weil hier die unterschiedlichen Intercepts (minus die der gehighlighteten Gruppen) alle aufeinander prallen.</p>
<p>Man bedenke auch: Der angenommene Effekt für x ändert sich ja nicht dadurch, dass ein random Intercept dazu kommt. Während ich bei den linearen Regressionsplots eine lineare Regression innerhalb jeder Gruppe rechne, verschiebe ich beim mixed Model die “mittlere” lineare Regression an der y-Achse entlang (oder?).</p>
<p><span style=" font-weight: bold;    color: #E8793A !important;">Siehe:</span> Vergleich von mixed models mit random Slopes vs. lineare Regressionen pro Gruppe <a href="5-randomslopes.html#randomslopes">ein Kapitel weiter</a>.</p>
</div>
</div>
<div id="veranderung-der-gruppengroen" class="section level3">
<h3><span class="header-section-number">4.3.6</span> Veränderung der Gruppengrößen</h3>
<p><span style=" font-weight: bold;    color: #ad4f19 !important;">2. Reset the values to the original. Change Ngroups to 50. What differences do you see in the confidence interval estimates?</span></p>
<p><span style=" font-weight: bold;    color: #ad4f19 !important;">3. Set the Ngroups back to 100. Now change NperGroup to 10, and note again the how the CI is different from the base condition.</span></p>
<ul>
<li>Run 1: <code>NGroups</code> = 100, <code>NperGroup</code> = 3</li>
<li>Run 5: <code>NGroups</code> = 50, <code>NperGroup</code> = 3</li>
<li>Run 6: <code>NGroups</code> = 100, <code>NperGroup</code> = 10</li>
</ul>
<table class="table table-striped" style="font-size: 14px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-42">Table 4.8: </span>Simulationsübersicht variierende Sample Sizes
</caption>
<thead>
<tr>
<th style="border-bottom:hidden" colspan="3">
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Standardabweichung
</div>
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Standard Error
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
effect
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
term
</th>
<th style="text-align:left;">
run1
</th>
<th style="text-align:left;">
run5
</th>
<th style="text-align:left;">
run6
</th>
<th style="text-align:left;">
run1
</th>
<th style="text-align:left;">
run5
</th>
<th style="text-align:left;">
run6
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
1.95
</td>
<td style="text-align:left;">
1.90
</td>
<td style="text-align:left;">
1.95
</td>
<td style="text-align:left;">
0.05
</td>
<td style="text-align:left;">
0.08
</td>
<td style="text-align:left;">
0.05
</td>
</tr>
<tr>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
x
</td>
<td style="text-align:left;">
0.50
</td>
<td style="text-align:left;">
0.50
</td>
<td style="text-align:left;">
0.51
</td>
<td style="text-align:left;">
0.02
</td>
<td style="text-align:left;">
0.02
</td>
<td style="text-align:left;">
0.01
</td>
</tr>
<tr>
<td style="text-align:left;">
random
</td>
<td style="text-align:left;">
groups
</td>
<td style="text-align:left;">
SD Intercept
</td>
<td style="text-align:left;">
0.50
</td>
<td style="text-align:left;">
0.56
</td>
<td style="text-align:left;">
0.51
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
random
</td>
<td style="text-align:left;">
residual
</td>
<td style="text-align:left;">
SD Observation
</td>
<td style="text-align:left;">
0.23
</td>
<td style="text-align:left;">
0.25
</td>
<td style="text-align:left;">
0.25
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
</tbody>
</table>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-43">Table 4.9: </span>Intraclass Correlations
</caption>
<thead>
<tr>
<th style="text-align:left;">
run1
</th>
<th style="text-align:left;">
run5
</th>
<th style="text-align:left;">
run6
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
81.99
</td>
<td style="text-align:left;">
83.77
</td>
<td style="text-align:left;">
81.30
</td>
</tr>
</tbody>
</table>
<p><img src="01_1_first_things_first_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<p><img src="01_1_first_things_first_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<p>Die vorherige Vermutung bestätigt sich: Je mehr Datenpunkte pro Gruppe es gibt, desto näher kommt die Schätzung durch lineare Regressionen pro Gruppe an die des Mixed Models dran.</p>
<p><img src="01_1_first_things_first_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<div id="confidence-intervals" class="section level4">
<h4><span class="header-section-number">4.3.6.1</span> Confidence Intervals</h4>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-47">Table 4.10: </span>CIs für variierende Sample Sizes
</caption>
<thead>
<tr>
<th style="border-bottom:hidden" colspan="1">
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
run1
</div>
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
run5
</div>
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
run6
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
2.5 %
</th>
<th style="text-align:left;">
97.5%
</th>
<th style="text-align:left;">
2.5 %
</th>
<th style="text-align:left;">
97.5%
</th>
<th style="text-align:left;">
2.5 %
</th>
<th style="text-align:left;">
97.5%
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
group
</td>
<td style="text-align:left;">
0.43
</td>
<td style="text-align:left;">
0.58
</td>
<td style="text-align:left;">
0.45
</td>
<td style="text-align:left;">
0.69
</td>
<td style="text-align:left;">
0.45
</td>
<td style="text-align:left;">
0.59
</td>
</tr>
<tr>
<td style="text-align:left;">
residual
</td>
<td style="text-align:left;">
0.21
</td>
<td style="text-align:left;">
0.26
</td>
<td style="text-align:left;">
0.21
</td>
<td style="text-align:left;">
0.28
</td>
<td style="text-align:left;">
0.24
</td>
<td style="text-align:left;">
0.26
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:left;">
1.85
</td>
<td style="text-align:left;">
2.05
</td>
<td style="text-align:left;">
1.74
</td>
<td style="text-align:left;">
2.06
</td>
<td style="text-align:left;">
1.85
</td>
<td style="text-align:left;">
2.05
</td>
</tr>
<tr>
<td style="text-align:left;">
x
</td>
<td style="text-align:left;">
0.47
</td>
<td style="text-align:left;">
0.53
</td>
<td style="text-align:left;">
0.45
</td>
<td style="text-align:left;">
0.55
</td>
<td style="text-align:left;">
0.49
</td>
<td style="text-align:left;">
0.52
</td>
</tr>
</tbody>
</table>
<ul>
<li>group = Standardabweichug vom Fixed Effect durch group</li>
<li>residual = Residual Standard Deviation von group</li>
</ul>
<p>Eine kleinere Gesamtstichprobe vergrößert die Unsicherheit über die Auswirkung von group, aber sonst nichts. Ein größeres n pro Gruppe (da das Gesamt-N gleich bleibt also weniger Gruppen) verändert … gar nichts?</p>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="3-exkurs-regressionen.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="5-randomslopes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": 3,
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
