<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.3 Simulationen | Mixed Models</title>
  <meta name="description" content="3.3 Simulationen | Mixed Models" />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="3.3 Simulationen | Mixed Models" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.3 Simulationen | Mixed Models" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="in-r.html">
<link rel="next" href="randomslopes.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="first-things-first.html"><a href="first-things-first.html"><i class="fa fa-check"></i><b>1</b> First Things First</a><ul>
<li class="chapter" data-level="1.1" data-path="uberblick.html"><a href="uberblick.html"><i class="fa fa-check"></i><b>1.1</b> Überblick</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="exkurs-regressionen.html"><a href="exkurs-regressionen.html"><i class="fa fa-check"></i><b>2</b> Exkurs Regressionen</a><ul>
<li class="chapter" data-level="2.1" data-path="averaging-ist-eine-least-squares-regression.html"><a href="averaging-ist-eine-least-squares-regression.html"><i class="fa fa-check"></i><b>2.1</b> Averaging ist eine Least-Squares Regression</a></li>
<li class="chapter" data-level="2.2" data-path="von-averaging-zur-regression.html"><a href="von-averaging-zur-regression.html"><i class="fa fa-check"></i><b>2.2</b> Von Averaging zur Regression</a></li>
<li class="chapter" data-level="2.3" data-path="pradiktoren-definieren.html"><a href="pradiktoren-definieren.html"><i class="fa fa-check"></i><b>2.3</b> Prädiktoren definieren</a></li>
<li class="chapter" data-level="2.4" data-path="codinginr.html"><a href="codinginr.html"><i class="fa fa-check"></i><b>2.4</b> Variablenkodierung in R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="random-intercept-models.html"><a href="random-intercept-models.html"><i class="fa fa-check"></i><b>3</b> Random intercept models</a><ul>
<li class="chapter" data-level="3.1" data-path="generelle-logik.html"><a href="generelle-logik.html"><i class="fa fa-check"></i><b>3.1</b> Generelle Logik</a></li>
<li class="chapter" data-level="3.2" data-path="in-r.html"><a href="in-r.html"><i class="fa fa-check"></i><b>3.2</b> in R</a></li>
<li class="chapter" data-level="3.3" data-path="simulationen.html"><a href="simulationen.html"><i class="fa fa-check"></i><b>3.3</b> Simulationen</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="randomslopes.html"><a href="randomslopes.html"><i class="fa fa-check"></i><b>4</b> Random slope models</a><ul>
<li class="chapter" data-level="4.1" data-path="mixed-models-vs-einzelne-regressionen.html"><a href="mixed-models-vs-einzelne-regressionen.html"><i class="fa fa-check"></i><b>4.1</b> Mixed Models vs. einzelne Regressionen</a></li>
<li class="chapter" data-level="4.2" data-path="simulationen-1.html"><a href="simulationen-1.html"><i class="fa fa-check"></i><b>4.2</b> Simulationen</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referenzen.html"><a href="referenzen.html"><i class="fa fa-check"></i>Referenzen</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Mixed Models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulationen" class="section level2">
<h2><span class="header-section-number">3.3</span> Simulationen</h2>
<p>Zum besseren Verständnis: Rumspielen mit verschiedenen Parametern von simulierten Daten und das entsprechende Resultat im mixed model. In den Notes anstatt in den Übungen, weil echt hilfreich. <span style=" font-weight: bold;    color: #6BBFA6 !important;">Übersicht aller Modelle und Density Plots nebeneinander in der Tabelle unten.</span></p>
<p>“In what follows we’ll change various aspects of the data, then rerun the model after each change […]. For each note specifically at least one thing that changed in the results.”</p>
<p><span style=" font-weight: bold;    color: #ad4f19 !important;">0. First calculate or simply eyeball the intraclass correlation coefficient:</span></p>
<p><span class="math display">\[\frac{\textrm{random effect variance}}{\textrm{residual + random effect variance}}\]</span>
<span style=" font-weight: bold;    color: #ad4f19 !important;">In addition, create a density plot of the random effects.</span></p>
<div id="run-1---default" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Run 1 - default</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># vorgegebener Code siehe mixed_models_basics.Rmd</span>
<span class="co"># Aber das geht so nicht - das muss erst mal in eine Funktion</span>
rand_int_sim &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">Ngroups =</span> <span class="dv">100</span>, <span class="dt">NperGroup =</span> <span class="dv">3</span>, <span class="dt">sdRandIntercept =</span> <span class="fl">.5</span>, 
                         <span class="dt">sdError =</span> <span class="fl">.25</span>, <span class="dt">sdFixedEffect =</span> <span class="fl">.5</span>, <span class="dt">AvIntercept =</span> <span class="dv">2</span>){
  N &lt;-<span class="st"> </span>Ngroups <span class="op">*</span><span class="st"> </span>NperGroup
  groups &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>Ngroups, <span class="dt">each =</span> NperGroup))
  u &lt;-<span class="st"> </span><span class="kw">rnorm</span>(Ngroups, <span class="dt">sd =</span> sdRandIntercept)
  e &lt;-<span class="st"> </span><span class="kw">rnorm</span>(N, <span class="dt">sd =</span> sdError)
  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(N)
  y &lt;-<span class="st"> </span>AvIntercept <span class="op">+</span><span class="st"> </span>sdFixedEffect <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>u[groups] <span class="op">+</span><span class="st"> </span>e
  
  <span class="kw">return</span>(<span class="kw">data.frame</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">groups =</span> groups))
}</code></pre>
<p><span style=" font-weight: bold;    color: #ad4f19 !important;">Which of the above represent the fixed and random effects?</span></p>
<p>x = fixed effect; u[groups] = random effect</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">2806</span>)
run1 &lt;-<span class="st"> </span><span class="kw">rand_int_sim</span>()

model1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>groups), <span class="dt">data =</span> run1)

<span class="kw">tidy</span>(model1) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate_at</span>(<span class="dt">.vars =</span> <span class="kw">c</span>(<span class="st">&quot;estimate&quot;</span>, <span class="st">&quot;std.error&quot;</span>, <span class="st">&quot;statistic&quot;</span>), 
            <span class="dt">.funs =</span> force_decimals) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">kable_styling</span>(<span class="st">&quot;striped&quot;</span>)</code></pre>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
effect
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
term
</th>
<th style="text-align:left;">
estimate
</th>
<th style="text-align:left;">
std.error
</th>
<th style="text-align:left;">
statistic
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:left;">
1.95
</td>
<td style="text-align:left;">
0.05
</td>
<td style="text-align:left;">
37.89
</td>
</tr>
<tr>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
x
</td>
<td style="text-align:left;">
0.50
</td>
<td style="text-align:left;">
0.02
</td>
<td style="text-align:left;">
32.65
</td>
</tr>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
groups
</td>
<td style="text-align:left;">
sd__(Intercept)
</td>
<td style="text-align:left;">
0.50
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
Residual
</td>
<td style="text-align:left;">
sd__Observation
</td>
<td style="text-align:left;">
0.23
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
</tbody>
</table>
<p>Einmal die Tabelle hier zur Veranschaulichung, alles Weitere in der Vergleichstabelle für alle Läufe unten. Intraclass Correlations und Density Plots ebenfalls unten.</p>
<p>Hier sehen wir aber zunächst, dass sich die von uns spezifizierten Parameter genau im Modell ablesen lassen: Die Residual Standard Deviation liegt bei .23 - wir haben dem error term e in der Simulation ja .25 zugewiesen. x wird (fast) genau wie spezifiziert auf .5 geschätzt. Und das Intercept passt auch: 1.95 (übergeben: 2). Das Intercept der groups hat eine Standard Deviation von .50 - passt auch beinahe genau. Bin noch nicht vollkommen sicher, wie ich die aufgeklärte Varianz beurteilen soll.</p>
<pre class="sourceCode r"><code class="sourceCode r">tb_intracl &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">formatVC</span>(<span class="kw">VarCorr</span>(model1), <span class="dt">comp =</span> <span class="kw">c</span>(<span class="st">&quot;Var&quot;</span>, <span class="st">&quot;Std&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Variance =</span> <span class="kw">as.numeric</span>(<span class="kw">as.character</span>(Variance)))

intracl1 &lt;-<span class="st"> </span>(tb_intracl<span class="op">$</span>Variance[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(tb_intracl<span class="op">$</span>Variance)) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></code></pre>
<p>Intraclass correlation: Groups klären <span class="math inline">\(81.99\)</span> <span class="math inline">\(\%\)</span> der Gesamtvarianz auf.</p>
</div>
<div id="run-2---different-random-effect-variance" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Run 2 - Different random effect variance</h3>
<p><span style=" font-weight: bold;    color: #ad4f19 !important;">1. Change the random effect variance/sd and/or the residual variance/sd and note your new estimate of the ICC, and plot the random effect as before.</span></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">2806</span>)
run2 &lt;-<span class="st"> </span><span class="kw">rand_int_sim</span>(<span class="dt">sdRandIntercept =</span> <span class="dv">1</span>)

model2 &lt;-<span class="st"> </span><span class="kw">lmer</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>groups), <span class="dt">data =</span> run2)</code></pre>
<p>Siehe Zusammenfassung unten: Im Prinzip sind alle Werte dieselben bis auf die Standard Deviation für das Intercept der Groups. Der ist jetzt bei 1 (vorher .50), und das ist ja auch das Einzige, was ich geändert habe. Interessanterweise gibt es leichte Abweichungen in den anderen Werten. Das sollte nicht daran liegen, dass ich eingangs zwar denselben Seed gesetzt habe, aber den Prozess des Samplings dann durch Änderungen in den Parametern vor dem Sampling des Intercepts verändert habe. Das sollte dann passieren, wenn ich das N ändere und somit der Startpunkt (vom Seed aus) für das Sampling des Intercepts ein anderer ist. Aber wenn ich hier keinen Denkfehler mache, wurde das Intercept leicht durch die Varianz des random effects (auf das Intercept) beeinflusst … ?</p>
<p>Intraclass correlation: Groups klären <span class="math inline">\(94.94\)</span> <span class="math inline">\(\%\)</span> der Gesamtvarianz auf. Was mega krass ist. Ergibt natürlich Sinn, weil ich die Varianz der Gruppen brutal hochgeschraubt habe. Ich verstehe nur noch nicht ganz, wieso die fixed effects hier nicht einbezogen werden, sondern nur der Effekt von group durch group <span class="math inline">\(+\)</span> residual gerechnet wird? Hat vermutlich damit zu tun, dass der Effekt von <span class="math inline">\(x\)</span> ja mit oder ohne random intercept derselbe bleibt.</p>
</div>
<div id="run-3---different-residual-variance" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Run 3 - Different residual variance</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">2806</span>)
run3 &lt;-<span class="st"> </span><span class="kw">rand_int_sim</span>(<span class="dt">sdError =</span> <span class="fl">.5</span>)

model3 &lt;-<span class="st"> </span><span class="kw">lmer</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>groups), <span class="dt">data =</span> run3)</code></pre>
<p>Siehe Zusammenfassung unten. Vergleich zum Default Model 1: Geändert hat sich nur die Residual Standard Deviation: Von .23 auf .47.</p>
<p>Intraclass correlation: Groups klären <span class="math inline">\(51.75\)</span> <span class="math inline">\(\%\)</span> der Gesamtvarianz auf. Also viel weniger als in Lauf 1 oder 2, weil das Residual natürlich umso mehr Varianz aufklärt.</p>
</div>
<div id="run-4---different-random-effect-and-residual-variance" class="section level3">
<h3><span class="header-section-number">3.3.4</span> Run 4 - Different random effect and residual variance</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">2806</span>)
run4 &lt;-<span class="st"> </span><span class="kw">rand_int_sim</span>(<span class="dt">sdRandIntercept =</span> <span class="dv">1</span>, <span class="dt">sdError =</span> <span class="fl">.5</span>)

model4 &lt;-<span class="st"> </span><span class="kw">lmer</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>groups), <span class="dt">data =</span> run4)</code></pre>
<p>Siehe Übersicht unten: Das sind jetzt die beiden Veränderungen aus Run 2 und 3 zusammengeführt.</p>
<p>Intraclass correlation: Groups klären <span class="math inline">\(81.99\)</span> <span class="math inline">\(\%\)</span> der Gesamtvarianz auf. Interessanterweise etwa so viel wie das default Modell 1.</p>
</div>
<div id="ubersicht" class="section level3">
<h3><span class="header-section-number">3.3.5</span> Übersicht</h3>
<ul>
<li>Run 1: default</li>
<li>Run 2: different random effect variance</li>
<li>Run 3: different residual variance</li>
<li>Run 4: different random effect and residual variance</li>
</ul>
<table class="table table-striped" style="font-size: 14px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-34">Table 2.6: </span>Simulationsübersicht
</caption>
<thead>
<tr>
<th style="border-bottom:hidden" colspan="3">
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="4">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Standardabweichung
</div>
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="4">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Standard Error
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
effect
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
term
</th>
<th style="text-align:left;">
run1
</th>
<th style="text-align:left;">
run2
</th>
<th style="text-align:left;">
run3
</th>
<th style="text-align:left;">
run4
</th>
<th style="text-align:left;">
run1
</th>
<th style="text-align:left;">
run2
</th>
<th style="text-align:left;">
run3
</th>
<th style="text-align:left;">
run4
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
1.95
</td>
<td style="text-align:left;">
1.90
</td>
<td style="text-align:left;">
1.94
</td>
<td style="text-align:left;">
1.89
</td>
<td style="text-align:left;">
0.05
</td>
<td style="text-align:left;">
0.10
</td>
<td style="text-align:left;">
0.06
</td>
<td style="text-align:left;">
0.10
</td>
</tr>
<tr>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
x
</td>
<td style="text-align:left;">
0.50
</td>
<td style="text-align:left;">
0.51
</td>
<td style="text-align:left;">
0.50
</td>
<td style="text-align:left;">
0.51
</td>
<td style="text-align:left;">
0.02
</td>
<td style="text-align:left;">
0.02
</td>
<td style="text-align:left;">
0.03
</td>
<td style="text-align:left;">
0.03
</td>
</tr>
<tr>
<td style="text-align:left;">
random
</td>
<td style="text-align:left;">
groups
</td>
<td style="text-align:left;">
SD Intercept
</td>
<td style="text-align:left;">
0.50
</td>
<td style="text-align:left;">
1.01
</td>
<td style="text-align:left;">
0.48
</td>
<td style="text-align:left;">
0.99
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
random
</td>
<td style="text-align:left;">
residual
</td>
<td style="text-align:left;">
SD Observation
</td>
<td style="text-align:left;">
0.23
</td>
<td style="text-align:left;">
0.23
</td>
<td style="text-align:left;">
0.47
</td>
<td style="text-align:left;">
0.46
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
</tbody>
</table>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-35">Table 2.7: </span>Intraclass Correlations
</caption>
<thead>
<tr>
<th style="text-align:left;">
run1
</th>
<th style="text-align:left;">
run2
</th>
<th style="text-align:left;">
run3
</th>
<th style="text-align:left;">
run4
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
81.99
</td>
<td style="text-align:left;">
94.94
</td>
<td style="text-align:left;">
51.75
</td>
<td style="text-align:left;">
81.99
</td>
</tr>
</tbody>
</table>
<div id="density-plots" class="section level4">
<h4><span class="header-section-number">3.3.5.1</span> Density Plots</h4>
<p>Orange ist der Mittelwert, der 0 ist. Spannend aber, wie asymmetrisch die sind. Run 2: Höhere Varianz des Random Effects bedeutet mehr Unsicherheit, wo er liegt? Run 3: Weil das Residual größer ist, schätzen wir den Effekt der Gruppe aufs Intercept eher auf 0? Rund 4: Sieht eher aus wie der aus Run 2. Die größere Varianz des Random Effects hat mehr Einfluss als die größere Residual Standard Deviation?</p>
<p><img src="01_1_first_things_first_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
</div>
<div id="lineare-regressionen" class="section level4">
<h4><span class="header-section-number">3.3.5.2</span> Lineare Regressionen</h4>
<p>Problem beim Plotten: Die Daten bestehen aus 100 3er-Grüppchen. Es ist nicht so übersichtlich, den Plot danach zu gruppieren. Daher hier mal vier rausgegriffen und der Rest zusammengefasst. Jede Gruppe hat eine lineare Regressionslinie bekommen. (Blau/orange vier herausgepickte Gruppen, grün-beige die restlichen Gruppen zusammengefasst.) Interessanterweise sieht es hier so aus, als wären auch ein Random Slopes pro Gruppe angemessen.</p>
<p><img src="01_1_first_things_first_files/figure-html/unnamed-chunk-37-1.png" width="110%" /></p>
</div>
<div id="mixed-models" class="section level4">
<h4><span class="header-section-number">3.3.5.3</span> Mixed Models</h4>
<p><img src="01_1_first_things_first_files/figure-html/unnamed-chunk-38-1.png" width="110%" /></p>
<p>D.h. wenn man jede Gruppe für sich linear schätzt (was <code>geom_smooth</code> mit <code>method = "lm"</code> hier ja tut), ergibt sich ein anderes Bild als durch das mixed model. Wir wissen ja durch die Simulation, dass es keine random slopes pro Gruppe gibt (vermutlich würde auch das lineare Modell ähnliche Schätzungen liefern, wenn es nicht nur drei Datenpunkte pro Gruppe wären). Schon krass irgendwo, dass ein mixed Model viel mehr ist (sein kann?) als einfach nur ein lineares Modell pro Gruppe. Man beachte, dass die zusammengefasste Schätzung für die restlichen Gruppen einen anderen Slope hat, weil hier die unterschiedlichen Intercepts (minus die der gehighlighteten Gruppen) alle aufeinander prallen.</p>
<p>Man bedenke auch: Der angenommene Effekt für x ändert sich ja nicht dadurch, dass ein random Intercept dazu kommt. Während ich bei den linearen Regressionsplots eine lineare Regression innerhalb jeder Gruppe rechne, verschiebe ich beim mixed Model die “mittlere” lineare Regression an der y-Achse entlang (oder?).</p>
<p><span style=" font-weight: bold;    color: #E8793A !important;">Siehe:</span> Vergleich von mixed models mit random Slopes vs. lineare Regressionen pro Gruppe <a href="randomslopes.html#randomslopes">ein Kapitel weiter</a>.</p>
</div>
</div>
<div id="veranderung-der-gruppengroen" class="section level3">
<h3><span class="header-section-number">3.3.6</span> Veränderung der Gruppengrößen</h3>
<p><span style=" font-weight: bold;    color: #ad4f19 !important;">2. Reset the values to the original. Change Ngroups to 50. What differences do you see in the confidence interval estimates?</span></p>
<p><span style=" font-weight: bold;    color: #ad4f19 !important;">3. Set the Ngroups back to 100. Now change NperGroup to 10, and note again the how the CI is different from the base condition.</span></p>
<ul>
<li>Run 1: <code>NGroups</code> = 100, <code>NperGroup</code> = 3</li>
<li>Run 5: <code>NGroups</code> = 50, <code>NperGroup</code> = 3</li>
<li>Run 6: <code>NGroups</code> = 100, <code>NperGroup</code> = 10</li>
</ul>
<table class="table table-striped" style="font-size: 14px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-40">Table 2.8: </span>Simulationsübersicht variierende Sample Sizes
</caption>
<thead>
<tr>
<th style="border-bottom:hidden" colspan="3">
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Standardabweichung
</div>
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Standard Error
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
effect
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
term
</th>
<th style="text-align:left;">
run1
</th>
<th style="text-align:left;">
run5
</th>
<th style="text-align:left;">
run6
</th>
<th style="text-align:left;">
run1
</th>
<th style="text-align:left;">
run5
</th>
<th style="text-align:left;">
run6
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
1.95
</td>
<td style="text-align:left;">
1.90
</td>
<td style="text-align:left;">
1.95
</td>
<td style="text-align:left;">
0.05
</td>
<td style="text-align:left;">
0.08
</td>
<td style="text-align:left;">
0.05
</td>
</tr>
<tr>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
x
</td>
<td style="text-align:left;">
0.50
</td>
<td style="text-align:left;">
0.50
</td>
<td style="text-align:left;">
0.51
</td>
<td style="text-align:left;">
0.02
</td>
<td style="text-align:left;">
0.02
</td>
<td style="text-align:left;">
0.01
</td>
</tr>
<tr>
<td style="text-align:left;">
random
</td>
<td style="text-align:left;">
groups
</td>
<td style="text-align:left;">
SD Intercept
</td>
<td style="text-align:left;">
0.50
</td>
<td style="text-align:left;">
0.56
</td>
<td style="text-align:left;">
0.51
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
random
</td>
<td style="text-align:left;">
residual
</td>
<td style="text-align:left;">
SD Observation
</td>
<td style="text-align:left;">
0.23
</td>
<td style="text-align:left;">
0.25
</td>
<td style="text-align:left;">
0.25
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
</tbody>
</table>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-41">Table 2.9: </span>Intraclass Correlations
</caption>
<thead>
<tr>
<th style="text-align:left;">
run1
</th>
<th style="text-align:left;">
run5
</th>
<th style="text-align:left;">
run6
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
81.99
</td>
<td style="text-align:left;">
83.77
</td>
<td style="text-align:left;">
81.30
</td>
</tr>
</tbody>
</table>
<p><img src="01_1_first_things_first_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p><img src="01_1_first_things_first_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>Die vorherige Vermutung bestätigt sich: Je mehr Datenpunkte pro Gruppe es gibt, desto näher kommt die Schätzung durch lineare Regressionen pro Gruppe an die des Mixed Models dran.</p>
<p><img src="01_1_first_things_first_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<div id="confidence-intervals" class="section level4">
<h4><span class="header-section-number">3.3.6.1</span> Confidence Intervals</h4>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-45">Table 2.10: </span>CIs für variierende Sample Sizes
</caption>
<thead>
<tr>
<th style="border-bottom:hidden" colspan="1">
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
run1
</div>
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
run5
</div>
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
run6
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
2.5 %
</th>
<th style="text-align:left;">
97.5%
</th>
<th style="text-align:left;">
2.5 %
</th>
<th style="text-align:left;">
97.5%
</th>
<th style="text-align:left;">
2.5 %
</th>
<th style="text-align:left;">
97.5%
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
group
</td>
<td style="text-align:left;">
0.43
</td>
<td style="text-align:left;">
0.58
</td>
<td style="text-align:left;">
0.45
</td>
<td style="text-align:left;">
0.69
</td>
<td style="text-align:left;">
0.45
</td>
<td style="text-align:left;">
0.59
</td>
</tr>
<tr>
<td style="text-align:left;">
residual
</td>
<td style="text-align:left;">
0.21
</td>
<td style="text-align:left;">
0.26
</td>
<td style="text-align:left;">
0.21
</td>
<td style="text-align:left;">
0.28
</td>
<td style="text-align:left;">
0.24
</td>
<td style="text-align:left;">
0.26
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:left;">
1.85
</td>
<td style="text-align:left;">
2.05
</td>
<td style="text-align:left;">
1.74
</td>
<td style="text-align:left;">
2.06
</td>
<td style="text-align:left;">
1.85
</td>
<td style="text-align:left;">
2.05
</td>
</tr>
<tr>
<td style="text-align:left;">
x
</td>
<td style="text-align:left;">
0.47
</td>
<td style="text-align:left;">
0.53
</td>
<td style="text-align:left;">
0.45
</td>
<td style="text-align:left;">
0.55
</td>
<td style="text-align:left;">
0.49
</td>
<td style="text-align:left;">
0.52
</td>
</tr>
</tbody>
</table>
<ul>
<li>group = Standardabweichug vom Fixed Effect durch group</li>
<li>residual = Residual Standard Deviation von group</li>
</ul>
<p>Eine kleinere Gesamtstichprobe vergrößert die Unsicherheit über die Auswirkung von group, aber sonst nichts. Ein größeres n pro Gruppe (da das Gesamt-N gleich bleibt also weniger Gruppen) verändert … gar nichts?</p>
</div>
</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="in-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="randomslopes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": 3,
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
