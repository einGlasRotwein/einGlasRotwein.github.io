<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.4 Mixed Model in R | NOTIZEN</title>
  <meta name="description" content="2.4 Mixed Model in R | NOTIZEN" />
  <meta name="generator" content="bookdown 0.10 and GitBook 2.6.7" />

  <meta property="og:title" content="2.4 Mixed Model in R | NOTIZEN" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.4 Mixed Model in R | NOTIZEN" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="problem-einfache-regression.html">
<link rel="next" href="simulationen.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="first-things-first.html"><a href="first-things-first.html"><i class="fa fa-check"></i><b>1</b> First Things First</a><ul>
<li class="chapter" data-level="1.1" data-path="hilfreiche-definitionen.html"><a href="hilfreiche-definitionen.html"><i class="fa fa-check"></i><b>1.1</b> Hilfreiche Definitionen</a><ul>
<li class="chapter" data-level="1.1.1" data-path="hilfreiche-definitionen.html"><a href="hilfreiche-definitionen.html#nested-und-clustered"><i class="fa fa-check"></i><b>1.1.1</b> Nested und clustered</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="random-intercept-models.html"><a href="random-intercept-models.html"><i class="fa fa-check"></i><b>2</b> Random intercept models</a><ul>
<li class="chapter" data-level="2.1" data-path="generelle-logik.html"><a href="generelle-logik.html"><i class="fa fa-check"></i><b>2.1</b> Generelle Logik</a></li>
<li class="chapter" data-level="2.2" data-path="fancy-plot-zum-klauen.html"><a href="fancy-plot-zum-klauen.html"><i class="fa fa-check"></i><b>2.2</b> Fancy Plot zum Klauen</a></li>
<li class="chapter" data-level="2.3" data-path="problem-einfache-regression.html"><a href="problem-einfache-regression.html"><i class="fa fa-check"></i><b>2.3</b> Problem einfache Regression</a></li>
<li class="chapter" data-level="2.4" data-path="mixed-model-in-r.html"><a href="mixed-model-in-r.html"><i class="fa fa-check"></i><b>2.4</b> Mixed Model in R</a><ul>
<li class="chapter" data-level="2.4.1" data-path="mixed-model-in-r.html"><a href="mixed-model-in-r.html#vergleich-einfache-regression-vs.-mixed-model"><i class="fa fa-check"></i><b>2.4.1</b> Vergleich einfache Regression vs. mixed model</a></li>
<li class="chapter" data-level="2.4.2" data-path="mixed-model-in-r.html"><a href="mixed-model-in-r.html#predictions-plotten"><i class="fa fa-check"></i><b>2.4.2</b> Predictions plotten</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="simulationen.html"><a href="simulationen.html"><i class="fa fa-check"></i><b>2.5</b> Simulationen</a><ul>
<li class="chapter" data-level="2.5.1" data-path="simulationen.html"><a href="simulationen.html#run-1---default"><i class="fa fa-check"></i><b>2.5.1</b> Run 1 - default</a></li>
<li class="chapter" data-level="2.5.2" data-path="simulationen.html"><a href="simulationen.html#run-2---different-random-effect-variance"><i class="fa fa-check"></i><b>2.5.2</b> Run 2 - Different random effect variance</a></li>
<li class="chapter" data-level="2.5.3" data-path="simulationen.html"><a href="simulationen.html#run-3---different-residual-variance"><i class="fa fa-check"></i><b>2.5.3</b> Run 3 - Different residual variance</a></li>
<li class="chapter" data-level="2.5.4" data-path="simulationen.html"><a href="simulationen.html#run-4---different-random-effect-and-residual-variance"><i class="fa fa-check"></i><b>2.5.4</b> Run 4 - Different random effect and residual variance</a></li>
<li class="chapter" data-level="2.5.5" data-path="simulationen.html"><a href="simulationen.html#ubersicht"><i class="fa fa-check"></i><b>2.5.5</b> Übersicht</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">NOTIZEN</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mixed-model-in-r" class="section level2">
<h2><span class="header-section-number">2.4</span> Mixed Model in R</h2>
<p>Notation, um das Intercept <code>1</code> pro Student variieren zu lassen: <code>(1|student)</code>. Ich benutze broom bzw. broom.mixed, um die Modelle aufgeräumt darzustellen. Im Code verwendet er summary, aber das ist da eher ein Krampf. Interessanterweise räumt er selbst seine Tabellen vor der Darstellung auch auf. Vermutlich per Hand.</p>
<p><span class="math inline">\(\to\)</span> Siehe Skript uebungen.R – Übung #2 für mixed Model.</p>
<pre class="sourceCode r"><code class="sourceCode r">gpa_mixed &lt;-<span class="st"> </span><span class="kw">lmer</span>(gpa <span class="op">~</span><span class="st"> </span>occasion <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>student), <span class="dt">data =</span> gpa)

gpa_mixed_coef &lt;-<span class="st"> </span><span class="kw">tidy</span>(gpa_mixed)
gpa_mixed_fit &lt;-<span class="st"> </span><span class="kw">glance</span>(gpa_mixed)</code></pre>
<div id="vergleich-einfache-regression-vs.-mixed-model" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Vergleich einfache Regression vs. mixed model</h3>
<p>Mixed model hat keine p-values im Output - auch nicht mit <code>summary</code>.</p>
<p>Interessant hierzu in mitgeliefertem Notebook <code>mixed_models_basics.Rmd</code>: “People always ask where the p-values are, but the answer is… complicated. Other packages and programs present them as if they are trivially obtained, but that is not the case, and the <code>lme4</code> developers would rather not make unnecessary assumptions. On the plus side, you can get interval estimates easily enough, even though they are poorly named for the variance components. <code>sigma01</code> is the student variance.”</p>
<p>Später schreibt er dazu, dass man in mixed models verschiedene Stichprobengrößen von Cluster zu Cluster hat, sowie das N der Gesamtstichprobe. Was es schwierig macht, eine Referenzverteilung zu bestimmen, bzgl. Freiheitsgrade und so.</p>
<table>
<caption>
<span id="tab:unnamed-chunk-6">Table 1.1: </span>std. regression
</caption>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:left;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
2.5992143
</td>
<td style="text-align:right;">
0.0178455
</td>
<td style="text-align:right;">
145.65086
</td>
<td style="text-align:left;">
p &lt; .001
</td>
</tr>
<tr>
<td style="text-align:left;">
occasion
</td>
<td style="text-align:right;">
0.1063143
</td>
<td style="text-align:right;">
0.0058942
</td>
<td style="text-align:right;">
18.03717
</td>
<td style="text-align:left;">
p &lt; .001
</td>
</tr>
</tbody>
</table>
<table>
<caption>
<span id="tab:unnamed-chunk-7">Table 1.2: </span>mixed model
</caption>
<thead>
<tr>
<th style="text-align:left;">
effect
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
statistic
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
2.5992143
</td>
<td style="text-align:right;">
0.0216964
</td>
<td style="text-align:right;">
119.7995
</td>
</tr>
<tr>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
occasion
</td>
<td style="text-align:right;">
0.1063143
</td>
<td style="text-align:right;">
0.0040739
</td>
<td style="text-align:right;">
26.0964
</td>
</tr>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
student
</td>
<td style="text-align:left;">
sd__(Intercept)
</td>
<td style="text-align:right;">
0.2524265
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
Residual
</td>
<td style="text-align:left;">
sd__Observation
</td>
<td style="text-align:right;">
0.2410156
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<ul>
<li>Koeffizienten der fixed effects sind dieselben wie in der normalen Regression!
<ul>
<li>Ist nicht immer der Fall, z.B. bei unbalancierten Daten - aber sollte wohl meistens dicht dran sein.</li>
<li>Hier: Studenten starten mit einem GPA von 2.6 und jedes Semester kommen .11 Punkte dazu.</li>
</ul></li>
<li><span style=" font-weight: bold;    color: #6BBFA6 !important;">Standardfehler</span> unterscheiden sich; der fürs Intercept ist gestiegen, der für den Messzeitpunkt ist runter gegangen.
<ul>
<li>Wir haben mehr Infos über das Individuum und drücken gleichzeitig gesteigerte Unsicherheit über Average (Intercept) aus.</li>
</ul></li>
</ul>
<table>
<caption>
<span id="tab:unnamed-chunk-8">Table 1.3: </span>std. regression pt. I
</caption>
<thead>
<tr>
<th style="text-align:right;">
r.squared
</th>
<th style="text-align:right;">
adj.r.squared
</th>
<th style="text-align:right;">
sigma
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
<th style="text-align:right;">
df
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.2135699
</td>
<td style="text-align:right;">
0.2129134
</td>
<td style="text-align:right;">
0.3487043
</td>
<td style="text-align:right;">
325.3394
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
<table>
<caption>
<span id="tab:unnamed-chunk-9">Table 1.4: </span>std. regression pt. II
</caption>
<thead>
<tr>
<th style="text-align:right;">
logLik
</th>
<th style="text-align:right;">
AIC
</th>
<th style="text-align:right;">
BIC
</th>
<th style="text-align:right;">
deviance
</th>
<th style="text-align:right;">
df.residual
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-437.4883
</td>
<td style="text-align:right;">
880.9766
</td>
<td style="text-align:right;">
896.2468
</td>
<td style="text-align:right;">
145.6705
</td>
<td style="text-align:right;">
1198
</td>
</tr>
</tbody>
</table>
<table>
<caption>
<span id="tab:unnamed-chunk-10">Table 1.5: </span>mixed model
</caption>
<thead>
<tr>
<th style="text-align:right;">
sigma
</th>
<th style="text-align:right;">
logLik
</th>
<th style="text-align:right;">
AIC
</th>
<th style="text-align:right;">
BIC
</th>
<th style="text-align:right;">
REMLcrit
</th>
<th style="text-align:right;">
df.residual
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.2410156
</td>
<td style="text-align:right;">
-204.4464
</td>
<td style="text-align:right;">
416.8929
</td>
<td style="text-align:right;">
437.2532
</td>
<td style="text-align:right;">
408.8929
</td>
<td style="text-align:right;">
1196
</td>
</tr>
</tbody>
</table>
<ul>
<li>Achtung, Verwirrung: Ich bekomme hier mit <code>broom</code> in beiden Fällen <span style=" font-weight: bold;    color: #E8793A !important;">sigma</span>, die <span style=" font-weight: bold;    color: #E8793A !important;">residual standard deviation</span>. Wenn ich die <code>summary</code>-Funktion auf das mixed model anwende, finde ich diesen Wert als <span style=" font-weight: bold;    color: #6BBFA6 !important;">residual standard deviation</span> in der Tabelle <span style=" font-weight: bold;    color: #6BBFA6 !important;">Random effects</span>. In <code>lm</code> heißt das aber <span style=" font-weight: bold;    color: #E8793A !important;">residual standard error</span> (in der Auflistung unterhalb der Tabelle). Das ist aber dasselbe und ist wohl nur falsch benannt! (siehe z.B. <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/sigma.html">hier</a>)
<ul>
<li>Beides ist jedenfalls inhaltlich dasselbe, aber die Werte unterscheiden sich: Die <span style=" font-weight: bold;    color: #6BBFA6 !important;">unaufgeklärte Varianz</span> wurde aufgeteilt.</li>
<li>Im mixed model findet man dieselbe Information auch noch mal in der Tabelle (3.2) in der Zeile <code>ran_pars - Residual - sd__Observation</code>, Spalte <code>estimate</code>.</li>
<li>Entsprechend gibt <code>estimate</code> in der Zeile darüber (<code>ran_pars - student - sd__(Intercept)</code>) die geschätzte Standardabweichung vom <span style=" font-weight: bold;    color: #E8793A !important;">fixed effect</span> an, mit anderen Worten: Wie sehr wir vom “normalen” (fixed) effect abweichen, wenn wir uns von Student zu Student bewegen (sprich: <span class="math inline">\(\tau\)</span> in der Formel oben).
<ul>
<li>Scores variieren von Student zu Student mehr als doppelt so viel wie von Semester zu Semester!</li>
</ul></li>
</ul></li>
</ul>
<p>Siehe hier abgefahrener Code, wie man nur diese Info ohne <code>broom</code> extrahiert:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">VarCorr</span>(gpa_mixed), <span class="dt">comp =</span> <span class="kw">c</span>(<span class="st">&quot;Var&quot;</span>, <span class="st">&quot;Std&quot;</span>)) </code></pre>
<pre><code>##  Groups   Name        Variance Std.Dev.
##  student  (Intercept) 0.063719 0.25243 
##  Residual             0.058089 0.24102</code></pre>
<p>Das können wir auch direkt nutzen (die Varianz steckt im Broom-Output nicht drin), um die Varianz, die durch die Studenten aufgeklärt wird in Bezug zur Gesamtvarianz zu setzen: <code>.064 / .064 + .058 =</code> 1.058. Genauer gesagt ist das das Verhältnis der Varianz between clusters zur Gesamtvarianz in <span class="math inline">\(y\)</span>. Das ist dann die <span style=" font-weight: bold;    color: #E8793A !important;">intraclass correlation</span>, weil das gleichzeitig auch ein Schätzer der Korrelation innerhalb eines Clusters ist.</p>
<div id="zugriff-auf-die-geschatzten-abweichungen-einzelner-individuen" class="section level4">
<h4><span class="header-section-number">2.4.1.1</span> Zugriff auf die geschätzten Abweichungen einzelner Individuen</h4>
<p>Hier wird also geschätzt, wie sehr jeder Student vom mittleren Intercept abweicht (im Mittel um 0!). <code>$student</code> bräuchten wir eigentlich nicht, weil hier eh nur diese Spalte drin steckt. Schätzungen bezeichnet man - höhö - als <span style=" font-weight: bold;    color: #6BBFA6 !important;">BLUPs oder EBLUPs</span> (= (empirical) best linear unbiased prediction). Im Workshop unter <a href="https://m-clark.github.io/mixed-models-with-R/random_intercepts.html#application"><span style=" font-weight: bold;    color: #397367 !important;">Application</span></a> <span class="math inline">\(\to\)</span> Estimates of the random effects findet sich auch Code, um geschätzte Intervalle für die Effekte via Bootstrapping zu finden und sehr schick zu plotten.</p>
<pre class="sourceCode r"><code class="sourceCode r">(random_effects &lt;-<span class="st"> </span><span class="kw">ranef</span>(gpa_mixed)<span class="op">$</span>student)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["(Intercept)"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"-0.070894965","_rn_":"1"},{"1":"-0.215578568","_rn_":"2"},{"1":"0.088256998","_rn_":"3"},{"1":"-0.186641848","_rn_":"4"},{"1":"0.030383557","_rn_":"5"},{"1":"-0.302388730","_rn_":"6"},{"1":"-0.143236767","_rn_":"7"},{"1":"0.218472240","_rn_":"8"},{"1":"0.102725358","_rn_":"9"},{"1":"0.015915196","_rn_":"10"},{"1":"0.363155843","_rn_":"11"},{"1":"0.001446836","_rn_":"12"},{"1":"0.522307806","_rn_":"13"},{"1":"0.117193718","_rn_":"14"},{"1":"-0.215578568","_rn_":"15"},{"1":"-0.128768407","_rn_":"16"},{"1":"-0.273452009","_rn_":"17"},{"1":"-0.302388730","_rn_":"18"},{"1":"-0.099831686","_rn_":"19"},{"1":"0.232940601","_rn_":"20"},{"1":"-0.302388730","_rn_":"21"},{"1":"0.117193718","_rn_":"22"},{"1":"0.073788637","_rn_":"23"},{"1":"0.001446836","_rn_":"24"},{"1":"0.392092564","_rn_":"25"},{"1":"-0.273452009","_rn_":"26"},{"1":"-0.374730531","_rn_":"27"},{"1":"0.117193718","_rn_":"28"},{"1":"0.102725358","_rn_":"29"},{"1":"0.218472240","_rn_":"30"},{"1":"-0.360262171","_rn_":"31"},{"1":"0.261877321","_rn_":"32"},{"1":"-0.128768407","_rn_":"33"},{"1":"-0.215578568","_rn_":"34"},{"1":"0.088256998","_rn_":"35"},{"1":"0.131662079","_rn_":"36"},{"1":"0.088256998","_rn_":"37"},{"1":"0.421029284","_rn_":"38"},{"1":"-0.056426605","_rn_":"39"},{"1":"0.276345682","_rn_":"40"},{"1":"0.522307806","_rn_":"41"},{"1":"-0.056426605","_rn_":"42"},{"1":"0.073788637","_rn_":"43"},{"1":"0.175067159","_rn_":"44"},{"1":"0.175067159","_rn_":"45"},{"1":"-0.287920370","_rn_":"46"},{"1":"-0.230046929","_rn_":"47"},{"1":"0.001446836","_rn_":"48"},{"1":"0.102725358","_rn_":"49"},{"1":"-0.070894965","_rn_":"50"},{"1":"-0.027489885","_rn_":"51"},{"1":"0.160598799","_rn_":"52"},{"1":"0.073788637","_rn_":"53"},{"1":"0.189535520","_rn_":"54"},{"1":"0.146130439","_rn_":"55"},{"1":"-0.258983649","_rn_":"56"},{"1":"0.073788637","_rn_":"57"},{"1":"-0.186641848","_rn_":"58"},{"1":"0.059320277","_rn_":"59"},{"1":"-0.157705127","_rn_":"60"},{"1":"0.261877321","_rn_":"61"},{"1":"-0.114300046","_rn_":"62"},{"1":"0.276345682","_rn_":"63"},{"1":"0.102725358","_rn_":"64"},{"1":"-0.244515289","_rn_":"65"},{"1":"0.204003880","_rn_":"66"},{"1":"-0.215578568","_rn_":"67"},{"1":"-0.273452009","_rn_":"68"},{"1":"-0.273452009","_rn_":"69"},{"1":"0.015915196","_rn_":"70"},{"1":"0.001446836","_rn_":"71"},{"1":"0.435497645","_rn_":"72"},{"1":"-0.215578568","_rn_":"73"},{"1":"0.218472240","_rn_":"74"},{"1":"0.030383557","_rn_":"75"},{"1":"0.160598799","_rn_":"76"},{"1":"0.478902726","_rn_":"77"},{"1":"-0.374730531","_rn_":"78"},{"1":"-0.476009054","_rn_":"79"},{"1":"0.204003880","_rn_":"80"},{"1":"0.044851917","_rn_":"81"},{"1":"0.305282402","_rn_":"82"},{"1":"0.247408961","_rn_":"83"},{"1":"-0.533882495","_rn_":"84"},{"1":"0.117193718","_rn_":"85"},{"1":"-0.186641848","_rn_":"86"},{"1":"0.001446836","_rn_":"87"},{"1":"-0.056426605","_rn_":"88"},{"1":"0.146130439","_rn_":"89"},{"1":"-0.056426605","_rn_":"90"},{"1":"-0.316857090","_rn_":"91"},{"1":"0.652523049","_rn_":"92"},{"1":"0.363155843","_rn_":"93"},{"1":"-0.056426605","_rn_":"94"},{"1":"-0.128768407","_rn_":"95"},{"1":"0.146130439","_rn_":"96"},{"1":"-0.056426605","_rn_":"97"},{"1":"0.189535520","_rn_":"98"},{"1":"-0.172173487","_rn_":"99"},{"1":"-0.447072333","_rn_":"100"},{"1":"0.334219123","_rn_":"101"},{"1":"-0.041958245","_rn_":"102"},{"1":"-0.143236767","_rn_":"103"},{"1":"0.088256998","_rn_":"104"},{"1":"0.768269931","_rn_":"105"},{"1":"-0.360262171","_rn_":"106"},{"1":"-0.345793811","_rn_":"107"},{"1":"-0.389198892","_rn_":"108"},{"1":"-0.070894965","_rn_":"109"},{"1":"-0.504945774","_rn_":"110"},{"1":"-0.432603973","_rn_":"111"},{"1":"0.218472240","_rn_":"112"},{"1":"-0.172173487","_rn_":"113"},{"1":"-0.041958245","_rn_":"114"},{"1":"-0.085363326","_rn_":"115"},{"1":"-0.128768407","_rn_":"116"},{"1":"-0.013021524","_rn_":"117"},{"1":"0.131662079","_rn_":"118"},{"1":"-0.215578568","_rn_":"119"},{"1":"0.117193718","_rn_":"120"},{"1":"0.088256998","_rn_":"121"},{"1":"0.247408961","_rn_":"122"},{"1":"-0.374730531","_rn_":"123"},{"1":"0.088256998","_rn_":"124"},{"1":"-0.201110208","_rn_":"125"},{"1":"-0.114300046","_rn_":"126"},{"1":"-0.345793811","_rn_":"127"},{"1":"-0.070894965","_rn_":"128"},{"1":"-0.070894965","_rn_":"129"},{"1":"0.131662079","_rn_":"130"},{"1":"0.305282402","_rn_":"131"},{"1":"0.160598799","_rn_":"132"},{"1":"-0.389198892","_rn_":"133"},{"1":"0.015915196","_rn_":"134"},{"1":"0.088256998","_rn_":"135"},{"1":"-0.172173487","_rn_":"136"},{"1":"-0.099831686","_rn_":"137"},{"1":"-0.070894965","_rn_":"138"},{"1":"0.204003880","_rn_":"139"},{"1":"-0.128768407","_rn_":"140"},{"1":"0.189535520","_rn_":"141"},{"1":"0.088256998","_rn_":"142"},{"1":"-0.041958245","_rn_":"143"},{"1":"0.088256998","_rn_":"144"},{"1":"-0.070894965","_rn_":"145"},{"1":"-0.287920370","_rn_":"146"},{"1":"0.392092564","_rn_":"147"},{"1":"-0.143236767","_rn_":"148"},{"1":"-0.056426605","_rn_":"149"},{"1":"-0.230046929","_rn_":"150"},{"1":"-0.186641848","_rn_":"151"},{"1":"-0.114300046","_rn_":"152"},{"1":"-0.027489885","_rn_":"153"},{"1":"0.218472240","_rn_":"154"},{"1":"-0.085363326","_rn_":"155"},{"1":"-0.085363326","_rn_":"156"},{"1":"0.334219123","_rn_":"157"},{"1":"-0.027489885","_rn_":"158"},{"1":"0.449966005","_rn_":"159"},{"1":"0.363155843","_rn_":"160"},{"1":"-0.099831686","_rn_":"161"},{"1":"-0.432603973","_rn_":"162"},{"1":"-0.041958245","_rn_":"163"},{"1":"-0.114300046","_rn_":"164"},{"1":"-0.013021524","_rn_":"165"},{"1":"0.189535520","_rn_":"166"},{"1":"0.204003880","_rn_":"167"},{"1":"0.261877321","_rn_":"168"},{"1":"0.261877321","_rn_":"169"},{"1":"0.392092564","_rn_":"170"},{"1":"-0.287920370","_rn_":"171"},{"1":"-0.041958245","_rn_":"172"},{"1":"0.261877321","_rn_":"173"},{"1":"0.117193718","_rn_":"174"},{"1":"0.088256998","_rn_":"175"},{"1":"-0.085363326","_rn_":"176"},{"1":"0.189535520","_rn_":"177"},{"1":"0.015915196","_rn_":"178"},{"1":"0.044851917","_rn_":"179"},{"1":"-0.230046929","_rn_":"180"},{"1":"-0.345793811","_rn_":"181"},{"1":"0.218472240","_rn_":"182"},{"1":"-0.258983649","_rn_":"183"},{"1":"0.015915196","_rn_":"184"},{"1":"0.088256998","_rn_":"185"},{"1":"-0.056426605","_rn_":"186"},{"1":"-0.360262171","_rn_":"187"},{"1":"0.146130439","_rn_":"188"},{"1":"0.204003880","_rn_":"189"},{"1":"-0.374730531","_rn_":"190"},{"1":"-0.027489885","_rn_":"191"},{"1":"-0.041958245","_rn_":"192"},{"1":"0.044851917","_rn_":"193"},{"1":"0.001446836","_rn_":"194"},{"1":"-0.403667252","_rn_":"195"},{"1":"-0.027489885","_rn_":"196"},{"1":"0.189535520","_rn_":"197"},{"1":"0.160598799","_rn_":"198"},{"1":"-0.186641848","_rn_":"199"},{"1":"0.348687483","_rn_":"200"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="addiert-zu-den-fixed-effects" class="section level4">
<h4><span class="header-section-number">2.4.1.2</span> … addiert zu den fixed effects</h4>
<p>Hier werden die individuellen Effekte zu den <span style=" font-weight: bold;    color: #6BBFA6 !important;">fixed effects</span> dazugerechnet; damit erhalten wir <span style=" font-weight: bold;    color: #E8793A !important;">random coefficients</span>. Für <code>occasion</code> ändert sich nichts, weil wir nicht erlaubt haben, dass der slope pro Student variiert.</p>
<pre class="sourceCode r"><code class="sourceCode r">(random_coefficients &lt;-<span class="st"> </span><span class="kw">coef</span>(gpa_mixed)<span class="op">$</span>student)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["(Intercept)"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["occasion"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"2.528319","2":"0.1063143","_rn_":"1"},{"1":"2.383636","2":"0.1063143","_rn_":"2"},{"1":"2.687471","2":"0.1063143","_rn_":"3"},{"1":"2.412572","2":"0.1063143","_rn_":"4"},{"1":"2.629598","2":"0.1063143","_rn_":"5"},{"1":"2.296826","2":"0.1063143","_rn_":"6"},{"1":"2.455978","2":"0.1063143","_rn_":"7"},{"1":"2.817687","2":"0.1063143","_rn_":"8"},{"1":"2.701940","2":"0.1063143","_rn_":"9"},{"1":"2.615129","2":"0.1063143","_rn_":"10"},{"1":"2.962370","2":"0.1063143","_rn_":"11"},{"1":"2.600661","2":"0.1063143","_rn_":"12"},{"1":"3.121522","2":"0.1063143","_rn_":"13"},{"1":"2.716408","2":"0.1063143","_rn_":"14"},{"1":"2.383636","2":"0.1063143","_rn_":"15"},{"1":"2.470446","2":"0.1063143","_rn_":"16"},{"1":"2.325762","2":"0.1063143","_rn_":"17"},{"1":"2.296826","2":"0.1063143","_rn_":"18"},{"1":"2.499383","2":"0.1063143","_rn_":"19"},{"1":"2.832155","2":"0.1063143","_rn_":"20"},{"1":"2.296826","2":"0.1063143","_rn_":"21"},{"1":"2.716408","2":"0.1063143","_rn_":"22"},{"1":"2.673003","2":"0.1063143","_rn_":"23"},{"1":"2.600661","2":"0.1063143","_rn_":"24"},{"1":"2.991307","2":"0.1063143","_rn_":"25"},{"1":"2.325762","2":"0.1063143","_rn_":"26"},{"1":"2.224484","2":"0.1063143","_rn_":"27"},{"1":"2.716408","2":"0.1063143","_rn_":"28"},{"1":"2.701940","2":"0.1063143","_rn_":"29"},{"1":"2.817687","2":"0.1063143","_rn_":"30"},{"1":"2.238952","2":"0.1063143","_rn_":"31"},{"1":"2.861092","2":"0.1063143","_rn_":"32"},{"1":"2.470446","2":"0.1063143","_rn_":"33"},{"1":"2.383636","2":"0.1063143","_rn_":"34"},{"1":"2.687471","2":"0.1063143","_rn_":"35"},{"1":"2.730876","2":"0.1063143","_rn_":"36"},{"1":"2.687471","2":"0.1063143","_rn_":"37"},{"1":"3.020244","2":"0.1063143","_rn_":"38"},{"1":"2.542788","2":"0.1063143","_rn_":"39"},{"1":"2.875560","2":"0.1063143","_rn_":"40"},{"1":"3.121522","2":"0.1063143","_rn_":"41"},{"1":"2.542788","2":"0.1063143","_rn_":"42"},{"1":"2.673003","2":"0.1063143","_rn_":"43"},{"1":"2.774281","2":"0.1063143","_rn_":"44"},{"1":"2.774281","2":"0.1063143","_rn_":"45"},{"1":"2.311294","2":"0.1063143","_rn_":"46"},{"1":"2.369167","2":"0.1063143","_rn_":"47"},{"1":"2.600661","2":"0.1063143","_rn_":"48"},{"1":"2.701940","2":"0.1063143","_rn_":"49"},{"1":"2.528319","2":"0.1063143","_rn_":"50"},{"1":"2.571724","2":"0.1063143","_rn_":"51"},{"1":"2.759813","2":"0.1063143","_rn_":"52"},{"1":"2.673003","2":"0.1063143","_rn_":"53"},{"1":"2.788750","2":"0.1063143","_rn_":"54"},{"1":"2.745345","2":"0.1063143","_rn_":"55"},{"1":"2.340231","2":"0.1063143","_rn_":"56"},{"1":"2.673003","2":"0.1063143","_rn_":"57"},{"1":"2.412572","2":"0.1063143","_rn_":"58"},{"1":"2.658535","2":"0.1063143","_rn_":"59"},{"1":"2.441509","2":"0.1063143","_rn_":"60"},{"1":"2.861092","2":"0.1063143","_rn_":"61"},{"1":"2.484914","2":"0.1063143","_rn_":"62"},{"1":"2.875560","2":"0.1063143","_rn_":"63"},{"1":"2.701940","2":"0.1063143","_rn_":"64"},{"1":"2.354699","2":"0.1063143","_rn_":"65"},{"1":"2.803218","2":"0.1063143","_rn_":"66"},{"1":"2.383636","2":"0.1063143","_rn_":"67"},{"1":"2.325762","2":"0.1063143","_rn_":"68"},{"1":"2.325762","2":"0.1063143","_rn_":"69"},{"1":"2.615129","2":"0.1063143","_rn_":"70"},{"1":"2.600661","2":"0.1063143","_rn_":"71"},{"1":"3.034712","2":"0.1063143","_rn_":"72"},{"1":"2.383636","2":"0.1063143","_rn_":"73"},{"1":"2.817687","2":"0.1063143","_rn_":"74"},{"1":"2.629598","2":"0.1063143","_rn_":"75"},{"1":"2.759813","2":"0.1063143","_rn_":"76"},{"1":"3.078117","2":"0.1063143","_rn_":"77"},{"1":"2.224484","2":"0.1063143","_rn_":"78"},{"1":"2.123205","2":"0.1063143","_rn_":"79"},{"1":"2.803218","2":"0.1063143","_rn_":"80"},{"1":"2.644066","2":"0.1063143","_rn_":"81"},{"1":"2.904497","2":"0.1063143","_rn_":"82"},{"1":"2.846623","2":"0.1063143","_rn_":"83"},{"1":"2.065332","2":"0.1063143","_rn_":"84"},{"1":"2.716408","2":"0.1063143","_rn_":"85"},{"1":"2.412572","2":"0.1063143","_rn_":"86"},{"1":"2.600661","2":"0.1063143","_rn_":"87"},{"1":"2.542788","2":"0.1063143","_rn_":"88"},{"1":"2.745345","2":"0.1063143","_rn_":"89"},{"1":"2.542788","2":"0.1063143","_rn_":"90"},{"1":"2.282357","2":"0.1063143","_rn_":"91"},{"1":"3.251737","2":"0.1063143","_rn_":"92"},{"1":"2.962370","2":"0.1063143","_rn_":"93"},{"1":"2.542788","2":"0.1063143","_rn_":"94"},{"1":"2.470446","2":"0.1063143","_rn_":"95"},{"1":"2.745345","2":"0.1063143","_rn_":"96"},{"1":"2.542788","2":"0.1063143","_rn_":"97"},{"1":"2.788750","2":"0.1063143","_rn_":"98"},{"1":"2.427041","2":"0.1063143","_rn_":"99"},{"1":"2.152142","2":"0.1063143","_rn_":"100"},{"1":"2.933433","2":"0.1063143","_rn_":"101"},{"1":"2.557256","2":"0.1063143","_rn_":"102"},{"1":"2.455978","2":"0.1063143","_rn_":"103"},{"1":"2.687471","2":"0.1063143","_rn_":"104"},{"1":"3.367484","2":"0.1063143","_rn_":"105"},{"1":"2.238952","2":"0.1063143","_rn_":"106"},{"1":"2.253420","2":"0.1063143","_rn_":"107"},{"1":"2.210015","2":"0.1063143","_rn_":"108"},{"1":"2.528319","2":"0.1063143","_rn_":"109"},{"1":"2.094269","2":"0.1063143","_rn_":"110"},{"1":"2.166610","2":"0.1063143","_rn_":"111"},{"1":"2.817687","2":"0.1063143","_rn_":"112"},{"1":"2.427041","2":"0.1063143","_rn_":"113"},{"1":"2.557256","2":"0.1063143","_rn_":"114"},{"1":"2.513851","2":"0.1063143","_rn_":"115"},{"1":"2.470446","2":"0.1063143","_rn_":"116"},{"1":"2.586193","2":"0.1063143","_rn_":"117"},{"1":"2.730876","2":"0.1063143","_rn_":"118"},{"1":"2.383636","2":"0.1063143","_rn_":"119"},{"1":"2.716408","2":"0.1063143","_rn_":"120"},{"1":"2.687471","2":"0.1063143","_rn_":"121"},{"1":"2.846623","2":"0.1063143","_rn_":"122"},{"1":"2.224484","2":"0.1063143","_rn_":"123"},{"1":"2.687471","2":"0.1063143","_rn_":"124"},{"1":"2.398104","2":"0.1063143","_rn_":"125"},{"1":"2.484914","2":"0.1063143","_rn_":"126"},{"1":"2.253420","2":"0.1063143","_rn_":"127"},{"1":"2.528319","2":"0.1063143","_rn_":"128"},{"1":"2.528319","2":"0.1063143","_rn_":"129"},{"1":"2.730876","2":"0.1063143","_rn_":"130"},{"1":"2.904497","2":"0.1063143","_rn_":"131"},{"1":"2.759813","2":"0.1063143","_rn_":"132"},{"1":"2.210015","2":"0.1063143","_rn_":"133"},{"1":"2.615129","2":"0.1063143","_rn_":"134"},{"1":"2.687471","2":"0.1063143","_rn_":"135"},{"1":"2.427041","2":"0.1063143","_rn_":"136"},{"1":"2.499383","2":"0.1063143","_rn_":"137"},{"1":"2.528319","2":"0.1063143","_rn_":"138"},{"1":"2.803218","2":"0.1063143","_rn_":"139"},{"1":"2.470446","2":"0.1063143","_rn_":"140"},{"1":"2.788750","2":"0.1063143","_rn_":"141"},{"1":"2.687471","2":"0.1063143","_rn_":"142"},{"1":"2.557256","2":"0.1063143","_rn_":"143"},{"1":"2.687471","2":"0.1063143","_rn_":"144"},{"1":"2.528319","2":"0.1063143","_rn_":"145"},{"1":"2.311294","2":"0.1063143","_rn_":"146"},{"1":"2.991307","2":"0.1063143","_rn_":"147"},{"1":"2.455978","2":"0.1063143","_rn_":"148"},{"1":"2.542788","2":"0.1063143","_rn_":"149"},{"1":"2.369167","2":"0.1063143","_rn_":"150"},{"1":"2.412572","2":"0.1063143","_rn_":"151"},{"1":"2.484914","2":"0.1063143","_rn_":"152"},{"1":"2.571724","2":"0.1063143","_rn_":"153"},{"1":"2.817687","2":"0.1063143","_rn_":"154"},{"1":"2.513851","2":"0.1063143","_rn_":"155"},{"1":"2.513851","2":"0.1063143","_rn_":"156"},{"1":"2.933433","2":"0.1063143","_rn_":"157"},{"1":"2.571724","2":"0.1063143","_rn_":"158"},{"1":"3.049180","2":"0.1063143","_rn_":"159"},{"1":"2.962370","2":"0.1063143","_rn_":"160"},{"1":"2.499383","2":"0.1063143","_rn_":"161"},{"1":"2.166610","2":"0.1063143","_rn_":"162"},{"1":"2.557256","2":"0.1063143","_rn_":"163"},{"1":"2.484914","2":"0.1063143","_rn_":"164"},{"1":"2.586193","2":"0.1063143","_rn_":"165"},{"1":"2.788750","2":"0.1063143","_rn_":"166"},{"1":"2.803218","2":"0.1063143","_rn_":"167"},{"1":"2.861092","2":"0.1063143","_rn_":"168"},{"1":"2.861092","2":"0.1063143","_rn_":"169"},{"1":"2.991307","2":"0.1063143","_rn_":"170"},{"1":"2.311294","2":"0.1063143","_rn_":"171"},{"1":"2.557256","2":"0.1063143","_rn_":"172"},{"1":"2.861092","2":"0.1063143","_rn_":"173"},{"1":"2.716408","2":"0.1063143","_rn_":"174"},{"1":"2.687471","2":"0.1063143","_rn_":"175"},{"1":"2.513851","2":"0.1063143","_rn_":"176"},{"1":"2.788750","2":"0.1063143","_rn_":"177"},{"1":"2.615129","2":"0.1063143","_rn_":"178"},{"1":"2.644066","2":"0.1063143","_rn_":"179"},{"1":"2.369167","2":"0.1063143","_rn_":"180"},{"1":"2.253420","2":"0.1063143","_rn_":"181"},{"1":"2.817687","2":"0.1063143","_rn_":"182"},{"1":"2.340231","2":"0.1063143","_rn_":"183"},{"1":"2.615129","2":"0.1063143","_rn_":"184"},{"1":"2.687471","2":"0.1063143","_rn_":"185"},{"1":"2.542788","2":"0.1063143","_rn_":"186"},{"1":"2.238952","2":"0.1063143","_rn_":"187"},{"1":"2.745345","2":"0.1063143","_rn_":"188"},{"1":"2.803218","2":"0.1063143","_rn_":"189"},{"1":"2.224484","2":"0.1063143","_rn_":"190"},{"1":"2.571724","2":"0.1063143","_rn_":"191"},{"1":"2.557256","2":"0.1063143","_rn_":"192"},{"1":"2.644066","2":"0.1063143","_rn_":"193"},{"1":"2.600661","2":"0.1063143","_rn_":"194"},{"1":"2.195547","2":"0.1063143","_rn_":"195"},{"1":"2.571724","2":"0.1063143","_rn_":"196"},{"1":"2.788750","2":"0.1063143","_rn_":"197"},{"1":"2.759813","2":"0.1063143","_rn_":"198"},{"1":"2.412572","2":"0.1063143","_rn_":"199"},{"1":"2.947902","2":"0.1063143","_rn_":"200"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Konfidenzintervalle für die Standardfehler kann man auch kriegen. <span style=" font-weight: bold;    color: #E8793A !important;">.sigma</span> bezieht sich auf die Schätzung für - klar - <span style=" font-weight: bold;    color: #E8793A !important;">sigma</span> (= <span style=" font-weight: bold;    color: #6BBFA6 !important;">residual standard error</span>) und <span style=" font-weight: bold;    color: #E8793A !important;">.sig01</span> bezieht sich auf die Varianz durch die Studenten.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">confint</span>(gpa_mixed)</code></pre>
<pre><code>##                  2.5 %    97.5 %
## .sig01      0.22517423 0.2824604
## .sigma      0.23071113 0.2518510
## (Intercept) 2.55665145 2.6417771
## occasion    0.09832589 0.1143027</code></pre>
</div>
</div>
<div id="predictions-plotten" class="section level3">
<h3><span class="header-section-number">2.4.2</span> Predictions plotten</h3>
<p>Sehr nice: Mal der Vergleich für die ersten drei Studenten für</p>
<ul>
<li><ol style="list-style-type: lower-alpha">
<li>das linear model</li>
</ol></li>
<li><ol start="2" style="list-style-type: lower-alpha">
<li>das mixed model mit den random effects “disabled”</li>
</ol>
<ul>
<li>… was hier dasselbe ist wie das lineare model.</li>
</ul></li>
<li><ol start="3" style="list-style-type: lower-alpha">
<li>das mixed model inklusive random effects</li>
</ol></li>
</ul>
<p><span style=" font-weight: bold;    color: #E8793A !important;">TO DO:</span> Wenn random slopes dazu kommen, coolen Plot mit Estimate für jeden einzelnen Studenten darstellen. Auch als coole animierte Version, siehe Introduction.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># a)</span>
predict_mixed_no_re &lt;-<span class="st">  </span><span class="kw">predict</span>(gpa_mixed, <span class="dt">re.form =</span> <span class="ot">NA</span>)
<span class="co"># b)</span>
predict_mixed &lt;-<span class="st">  </span><span class="kw">predict</span>(gpa_mixed)
<span class="co"># c)</span>
predict_lm &lt;-<span class="st">  </span><span class="kw">predict</span>(gpa_lm)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">df_predictions &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">student =</span> gpa<span class="op">$</span>student, <span class="dt">occasion =</span> gpa<span class="op">$</span>occasion,
                             <span class="dt">gpa =</span> gpa<span class="op">$</span>gpa, <span class="dt">mixed_no_re =</span> predict_mixed_no_re,
                             <span class="dt">mixed =</span> predict_mixed, <span class="dt">lm =</span> predict_lm) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(student <span class="op">%in%</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)

df_for_plot &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
  <span class="dt">source =</span> <span class="kw">c</span>(<span class="kw">case_when</span>(df_predictions<span class="op">$</span>student <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> &quot;mixed student 1&quot;</span>,
                       df_predictions<span class="op">$</span>student <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> &quot;mixed student 2&quot;</span>,
                       df_predictions<span class="op">$</span>student <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> &quot;mixed student 3&quot;</span>),
             <span class="kw">rep</span>(<span class="st">&quot;linear model&quot;</span>, <span class="dv">6</span>)),
  <span class="dt">occasion =</span> <span class="kw">c</span>(df_predictions<span class="op">$</span>occasion, <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>),
  <span class="dt">gpa =</span> <span class="kw">c</span>(df_predictions<span class="op">$</span>gpa, <span class="kw">rep</span>(<span class="ot">NA</span>, <span class="dv">6</span>)),
  <span class="dt">prediction =</span> <span class="kw">c</span>(df_predictions<span class="op">$</span>mixed, 
                 df_predictions<span class="op">$</span>lm[df_predictions<span class="op">$</span>student <span class="op">==</span><span class="st"> </span><span class="dv">1</span>])
)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">df_for_plot <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> occasion)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> gpa, <span class="dt">colour =</span> source)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">y =</span> prediction, <span class="dt">colour =</span> source), <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,
              <span class="dt">fullrange =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_manual</span>(<span class="st">&quot;prediction&quot;</span>, <span class="dt">values =</span> <span class="kw">c</span>(<span class="kw">pick_colour</span>(<span class="dv">5</span>, <span class="st">&quot;farbschema&quot;</span>)),
                      <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="dv">2</span>)) <span class="op">+</span>
<span class="st">  </span>julis_theme</code></pre>
<p><img src="01_first_things_first_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p><span class="math inline">\(\to\)</span> Siehe Skript uebungen.R – Übung #2 für dasselbe nochmal, nur diesmal mit Schlaf-Beispieldaten.</p>
<p><span class="math inline">\(\to\)</span> Siehe Skript uebungen.R – Übung #3 Cluster Level Covariance (d.h. mehr fixed effects … ?) für die GPA-Daten</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="problem-einfache-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simulationen.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": 3,
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
